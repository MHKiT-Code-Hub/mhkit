<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Extreme Conditions Modeling - Full Sea State Approach &mdash; MHKiT v0.7.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/nbsphinx-code-cells.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/mhkit.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MHKit Short-term Extreme Loads" href="short_term_extremes_example.html" />
    <link rel="prev" title="Extreme Conditions Modeling - Contour Approach" href="extreme_response_contour_example.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MHKiT
          </a>
              <div class="version">
                v0.7.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="qc.html">QC Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="wave.html">Wave Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="river.html">River Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="tidal.html">Tidal Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="power.html">Power Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="loads.html">Loads Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dolfyn.html">DOLfYN Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mooring.html">Mooring Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils Module</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="python.html">MHKiT-Python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="python.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html#api-documentation">API Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="python.html#examples">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="qc_example.html">MHKiT Quality Control Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="wave_example.html">MHKiT Wave Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="river_example.html">MHKiT River Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="tidal_example.html">MHKiT Tidal Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="power_example.html">MHKiT Power Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="loads_example.html">MHKiT Loads Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="environmental_contours_example.html">MHKiT Environmental Contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="wecsim_example.html">MHKiT WEC-Sim Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="SWAN_example.html">MHKiT SWAN Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="WPTO_hindcast_example.html">MHKiT WPTO Hindcast Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="cdip_example.html">MHKiT CDIP IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="PacWave_resource_characterization_example.html">PacWave Resource Assessment</a></li>
<li class="toctree-l3"><a class="reference internal" href="directional_waves.html">Directional Wave Spectrum from NDBC Buoys</a></li>
<li class="toctree-l3"><a class="reference internal" href="metocean_example.html">MHKiT Metocean Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="metocean_example.html#1.-Request-Continuous-Wind-Data-from-NDBC">1. Request Continuous Wind Data from NDBC</a></li>
<li class="toctree-l3"><a class="reference internal" href="Delft3D_example.html">Delft3D IO Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="adcp_example.html">Reading ADCP Data with MHKiT</a></li>
<li class="toctree-l3"><a class="reference internal" href="ADCP_Delft3D_TRTS_example.html">Comparing Transect Data at the Tanana River Test Site</a></li>
<li class="toctree-l3"><a class="reference internal" href="adv_example.html">Reading ADV Data with MHKiT</a></li>
<li class="toctree-l3"><a class="reference internal" href="extreme_response_MLER_example.html">MLER example</a></li>
<li class="toctree-l3"><a class="reference internal" href="extreme_response_contour_example.html">Extreme Conditions Modeling - Contour Approach</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Extreme Conditions Modeling - Full Sea State Approach</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Obtain-and-Process-NDBC-Buouy-Data">Obtain and Process NDBC Buouy Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#1.-Sampling">1. Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#2.-Short-Term-Extreme-Distributions">2. Short-Term Extreme Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#3.-Long-Term-Extreme-Distribution">3. Long-Term Extreme Distribution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="short_term_extremes_example.html">MHKit Short-term Extreme Loads</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="python.html#online-forum">Online Forum</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html#software-tests">Software Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="matlab.html">MHKiT-MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="webinars.html">Webinars</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="citeus.html">Cite Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Online Forum</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MHKiT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="python.html">MHKiT-Python</a></li>
      <li class="breadcrumb-item active">Extreme Conditions Modeling - Full Sea State Approach</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/extreme_response_full_sea_state_example.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Extreme-Conditions-Modeling---Full-Sea-State-Approach">
<h1>Extreme Conditions Modeling - Full Sea State Approach<a class="headerlink" href="#Extreme-Conditions-Modeling---Full-Sea-State-Approach" title="Permalink to this heading"></a></h1>
<p>Extreme conditions modeling consists of identifying the expected extreme (e.g. 100-year) response of some quantity of interest, such as WEC motions or mooring loads. Three different methods of estimating extreme conditions were adapted from <a class="reference external" href="https://github.com/WEC-Sim/WDRT">WDRT</a>: full sea state approach, contour approach, and MLER design wave. This noteboook presents the full sea state approach.</p>
<p>The full sea state approach consists of the following steps: 1. Take <span class="math notranslate nohighlight">\(N\)</span> samples to represent the sea state. Each sample represents a small area of the sea state and consists of a representative <span class="math notranslate nohighlight">\((H_{s}, T_{e})_i\)</span> pair and a weight <span class="math notranslate nohighlight">\(W_i\)</span> associated with the probability of that sea state area. 2. For each sample <span class="math notranslate nohighlight">\((H_{s}, T_{e})_i\)</span> calculate the short-term (e.g. 3-hours) extreme for the quantity of interest (e.g. WEC motions or mooring tension). 3. Integrate over the entire
sea state to obtain the long-term extreme. This is a sum of the products of the weight of each sea state times the short-term extreme.</p>
<p>See more details and equations in</p>
<blockquote>
<div><p>[1] Coe, Ryan G., Carlos A. Michelén Ströfer, Aubrey Eckert-Gallup, and Cédric Sallaberry. 2018. “Full Long-Term Design Response Analysis of a Wave Energy Converter.” Renewable Energy 116: 356–66.</p>
</div></blockquote>
<p><strong>NOTE:</strong> Prior to running this example it is recommended to become familiar with <code class="docutils literal notranslate"><span class="pre">environmental_contours_example.ipynb</span></code> and <code class="docutils literal notranslate"><span class="pre">short_term_extremes_example.ipynb</span></code> since some code blocks are adapted from those examples and used here without the additional description.</p>
<p>We start by importing the relevant modules, including <code class="docutils literal notranslate"><span class="pre">waves.contours</span></code> submodule which includes the sampling function, and <code class="docutils literal notranslate"><span class="pre">loads.extreme</span></code> which inlcudes the short-term extreme and full sea state integration functions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mhkit.wave</span> <span class="kn">import</span> <span class="n">resource</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="n">graphics</span>
<span class="kn">from</span> <span class="nn">mhkit.loads</span> <span class="kn">import</span> <span class="n">extreme</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mhkit.wave.io</span> <span class="kn">import</span> <span class="n">ndbc</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<section id="Obtain-and-Process-NDBC-Buouy-Data">
<h2>Obtain and Process NDBC Buouy Data<a class="headerlink" href="#Obtain-and-Process-NDBC-Buouy-Data" title="Permalink to this heading"></a></h2>
<p>The first step will be obtaining the environmental data and creating the contours. See <code class="docutils literal notranslate"><span class="pre">environmental_contours_example.ipynb</span></code> for more details and explanations of how this is being done in the following code block.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameter</span> <span class="o">=</span> <span class="s1">&#39;swden&#39;</span>
<span class="n">buoy_number</span> <span class="o">=</span> <span class="s1">&#39;46022&#39;</span>
<span class="n">ndbc_available_data</span> <span class="o">=</span> <span class="n">ndbc</span><span class="o">.</span><span class="n">available_data</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">buoy_number</span><span class="p">)</span>

<span class="n">years_of_interest</span> <span class="o">=</span> <span class="n">ndbc_available_data</span><span class="p">[</span><span class="n">ndbc_available_data</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;</span> <span class="mi">2013</span><span class="p">]</span>

<span class="n">filenames</span> <span class="o">=</span> <span class="n">years_of_interest</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span>
<span class="n">ndbc_requested_data</span> <span class="o">=</span> <span class="n">ndbc</span><span class="o">.</span><span class="n">request_data</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">filenames</span><span class="p">)</span>

<span class="n">ndbc_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">ndbc_requested_data</span><span class="p">:</span>
    <span class="n">year_data</span> <span class="o">=</span> <span class="n">ndbc_requested_data</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
    <span class="n">ndbc_data</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndbc</span><span class="o">.</span><span class="n">to_datetime_index</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">year_data</span><span class="p">)</span>

<span class="n">Hm0_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Te_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterate over each year and save the result in the initalized dictionary</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">ndbc_data</span><span class="p">:</span>
    <span class="n">year_data</span> <span class="o">=</span> <span class="n">ndbc_data</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
    <span class="n">Hm0_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">significant_wave_height</span><span class="p">(</span><span class="n">year_data</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
    <span class="n">Te_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">energy_period</span><span class="p">(</span><span class="n">year_data</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>

<span class="c1"># Concatenate list of Series into a single DataFrame</span>
<span class="n">Te</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">Te_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Hm0</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">Hm0_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Hm0_Te</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Hm0</span><span class="p">,</span> <span class="n">Te</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Drop any NaNs created from the calculation of Hm0 or Te</span>
<span class="n">Hm0_Te</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Sort the DateTime index</span>
<span class="n">Hm0_Te</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">Hm0_Te_clean</span> <span class="o">=</span> <span class="n">Hm0_Te</span><span class="p">[</span><span class="n">Hm0_Te</span><span class="o">.</span><span class="n">Hm0</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">]</span>

<span class="n">Hm0</span> <span class="o">=</span> <span class="n">Hm0_Te_clean</span><span class="o">.</span><span class="n">Hm0</span><span class="o">.</span><span class="n">values</span>
<span class="n">Te</span> <span class="o">=</span> <span class="n">Hm0_Te_clean</span><span class="o">.</span><span class="n">Te</span><span class="o">.</span><span class="n">values</span>

<span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">Hm0_Te_clean</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">Hm0_Te_clean</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">seconds</span>
</pre></div>
</div>
</div>
</section>
<section id="1.-Sampling">
<h2>1. Sampling<a class="headerlink" href="#1.-Sampling" title="Permalink to this heading"></a></h2>
<p>The first step is sampling the sea state to get samples <span class="math notranslate nohighlight">\((H_s, T_e)_i\)</span> and associtated weights. For this we will use the <code class="docutils literal notranslate"><span class="pre">waves.contours.samples_full_seastate</span></code> function. We will sample 20 points between each return level, for 10 levels ranging from 0.001—100 years return periods. For more details on the sampling approach see</p>
<blockquote>
<div><p>[1] Coe, Ryan G., Carlos A. Michelén Ströfer, Aubrey Eckert-Gallup, and Cédric Sallaberry. 2018. “Full Long-Term Design Response Analysis of a Wave Energy Converter.” Renewable Energy 116: 356–66.</p>
</div></blockquote>
<blockquote>
<div><p>[2] Eckert-Gallup, Aubrey C., Cédric J. Sallaberry, Ann R. Dallman, and Vincent S. Neary. 2016. “Application of Principal Component Analysis (PCA) and Improved Joint Probability Distributions to the Inverse First-Order Reliability Method (I-FORM) for Predicting Extreme Sea States.” Ocean Engineering 112 (January): 307–19.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># return levels</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>

<span class="c1"># points per return level interval</span>
<span class="n">npoints</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># Create samples</span>
<span class="n">sample_hs</span><span class="p">,</span> <span class="n">sample_te</span><span class="p">,</span> <span class="n">sample_weights</span> <span class="o">=</span> <span class="n">contours</span><span class="o">.</span><span class="n">samples_full_seastate</span><span class="p">(</span>
    <span class="n">Hm0</span><span class="p">,</span> <span class="n">Te</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We will now plot the samples alongside the contours. First we will create the different contours using <code class="docutils literal notranslate"><span class="pre">contours.environmental_contours</span></code>. See <code class="docutils literal notranslate"><span class="pre">environmental_contours_example.ipynb</span></code> for more details on using this function. There are 20 samples, randomly distributed, between each set of return levels.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the contours</span>
<span class="n">Te_contours</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Hm0_contours</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">:</span>
    <span class="n">copula</span> <span class="o">=</span> <span class="n">contours</span><span class="o">.</span><span class="n">environmental_contours</span><span class="p">(</span>
        <span class="n">Hm0</span><span class="p">,</span> <span class="n">Te</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="s1">&#39;PCA&#39;</span><span class="p">,</span> <span class="n">return_PCA</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">Hm0_contours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copula</span><span class="p">[</span><span class="s1">&#39;PCA_x1&#39;</span><span class="p">])</span>
    <span class="n">Te_contours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copula</span><span class="p">[</span><span class="s1">&#39;PCA_x2&#39;</span><span class="p">])</span>

<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s2">-year Contour&quot;</span> <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">]</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">graphics</span><span class="o">.</span><span class="n">plot_environmental_contour</span><span class="p">(</span>
    <span class="n">sample_te</span><span class="p">,</span> <span class="n">sample_hs</span><span class="p">,</span> <span class="n">Te_contours</span><span class="p">,</span> <span class="n">Hm0_contours</span><span class="p">,</span>
    <span class="n">data_label</span><span class="o">=</span><span class="s1">&#39;Samples&#39;</span><span class="p">,</span> <span class="n">contour_label</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Energy Period, $Te$ [s]&#39;</span><span class="p">,</span>
    <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Sig. wave height, $Hm0$ [m]&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/extreme_response_full_sea_state_example_7_0.png" src="_images/extreme_response_full_sea_state_example_7_0.png" />
</div>
</div>
</section>
<section id="2.-Short-Term-Extreme-Distributions">
<h2>2. Short-Term Extreme Distributions<a class="headerlink" href="#2.-Short-Term-Extreme-Distributions" title="Permalink to this heading"></a></h2>
<p>Many different methods for short-term extremes were adapted from WDRT, and a summary and examples can be found in <code class="docutils literal notranslate"><span class="pre">short_term_extremes_example.ipynb</span></code>. The response quantity of interest is typically related to the WEC itself, e.g. maximum heave displacement, PTO extension, or load on the mooring lines. This requires running a simulation (e.g. WEC-Sim) for each of the 200 sampled sea states <span class="math notranslate nohighlight">\((H_s, T_e)_i\)</span>. For the sake of example we will consider the wave elevation as the quantity of
interest (can be thought as a proxy for heave motion in this example). Wave elevation time-series for a specific sea state can be created quickly without running any external software.</p>
<p><strong>NOTE:</strong> The majority of the for loop below is simply creating the synthetic data (wave elevation time series). In a realistic case the variables <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">data</span></code> describing each time series would be obtained externally, e.g. through simulation software such as WEC-Sim or CFD. For this reason the details of creating the synthetic data are not presented here, instead assume for each sea state there is time-series data available.</p>
<p>The last lines of the for-loop create the short-term extreme distribution from the time-series using the <code class="docutils literal notranslate"><span class="pre">loads.extreme.short_term_extreme</span></code> function. The short-term period will be 3-hours and we will use 1-hour “simulations” and the Weibul-tail-fitting method to estimate the 3-hour short-term extreme distributions for each of the 200 samples.</p>
<p>For more details on short-term extreme distributions see <code class="docutils literal notranslate"><span class="pre">short_term_extremes_example.ipynb</span></code> and</p>
<blockquote>
<div><p>[3] Michelén Ströfer, Carlos A., and Ryan Coe. 2015. “Comparison of Methods for Estimating Short-Term Extreme Response of Wave Energy Converters.” In OCEANS 2015 - MTS/IEEE Washington, 1–6. IEEE.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the short-term extreme distribution for each sample sea state</span>
<span class="n">t_st</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="mf">60.0</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">3.3</span>
<span class="n">t_sim</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="mf">60.0</span>

<span class="n">ste_all</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_hs</span><span class="p">)</span>
<span class="k">for</span> <span class="n">hs</span><span class="p">,</span> <span class="n">te</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sample_hs</span><span class="p">,</span> <span class="n">sample_te</span><span class="p">):</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="n">te</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.8255</span> <span class="o">+</span> <span class="mf">0.03852</span><span class="o">*</span><span class="n">gamma</span> <span class="o">-</span> <span class="mf">0.005537</span><span class="o">*</span><span class="n">gamma</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.0003154</span><span class="o">*</span><span class="n">gamma</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sea state </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">. (Hs, Te) = (</span><span class="si">{</span><span class="n">hs</span><span class="si">}</span><span class="s2"> m, </span><span class="si">{</span><span class="n">te</span><span class="si">}</span><span class="s2"> s). Tp = </span><span class="si">{</span><span class="n">tp</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
    <span class="c1"># time &amp; frequency arrays</span>
    <span class="n">f0</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">t_sim</span>
    <span class="n">T_min</span> <span class="o">=</span> <span class="n">tp</span><span class="o">/</span><span class="mf">10.0</span>  <span class="c1"># s</span>
    <span class="n">f_max</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">T_min</span>
    <span class="n">Nf</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f_max</span><span class="o">/</span><span class="n">f0</span><span class="p">)</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_sim</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">Nf</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span> <span class="n">f_max</span><span class="p">,</span> <span class="n">Nf</span><span class="p">)</span>
    <span class="c1"># spectrum</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">jonswap_spectrum</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">hs</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
    <span class="c1"># 1-hour elevation time-series</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">surface_elevation</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="c1"># 3-hour extreme distribution</span>
    <span class="n">ste</span> <span class="o">=</span> <span class="n">extreme</span><span class="o">.</span><span class="n">short_term_extreme</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">t_st</span><span class="p">,</span> <span class="s1">&#39;peaks_weibull_tail_fit&#39;</span><span class="p">)</span>
    <span class="n">ste_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ste</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Sea state 1/200. (Hs, Te) = (2.7476690431712387 m, 9.898396804782426 s). Tp = 10.953763434059923 s
Sea state 2/200. (Hs, Te) = (3.531570115440943 m, 11.072854690290276 s). Tp = 12.253441967345596 s
Sea state 3/200. (Hs, Te) = (3.5631169008261416 m, 10.529043453084103 s). Tp = 11.651649600094585 s
Sea state 4/200. (Hs, Te) = (3.3136880458617415 m, 9.477416257821945 s). Tp = 10.48789795981279 s
Sea state 5/200. (Hs, Te) = (3.172687890319087 m, 9.360633157328573 s). Tp = 10.35866345031299 s
Sea state 6/200. (Hs, Te) = (3.0630002153170452 m, 8.59765613746172 s). Tp = 9.514337854353085 s
Sea state 7/200. (Hs, Te) = (2.7069002802048345 m, 8.619396416083681 s). Tp = 9.538396080519615 s
Sea state 8/200. (Hs, Te) = (2.4473757676516734 m, 8.436380373858702 s). Tp = 9.335866875971888 s
Sea state 9/200. (Hs, Te) = (2.046394958916393 m, 7.376850430979894 s). Tp = 8.163369897472288 s
Sea state 10/200. (Hs, Te) = (2.293289736769183 m, 8.853033813999282 s). Tp = 9.796943887461476 s
Sea state 11/200. (Hs, Te) = (2.2020532526799967 m, 8.69872911280172 s). Tp = 9.626187225850904 s
Sea state 12/200. (Hs, Te) = (2.0876480479410366 m, 8.539262027183852 s). Tp = 9.449717766621593 s
Sea state 13/200. (Hs, Te) = (1.8902057494339104 m, 8.529332396785021 s). Tp = 9.438729439469068 s
Sea state 14/200. (Hs, Te) = (2.308096327590195 m, 9.112272664224243 s). Tp = 10.083822772424941 s
Sea state 15/200. (Hs, Te) = (1.9622893666119121 m, 9.151949676311485 s). Tp = 10.127730145785039 s
Sea state 16/200. (Hs, Te) = (2.305667961346008 m, 9.200023294046321 s). Tp = 10.18092937051529 s
Sea state 17/200. (Hs, Te) = (1.9701858425767147 m, 10.185262006644049 s). Tp = 11.27121419104896 s
Sea state 18/200. (Hs, Te) = (2.292470528080541 m, 9.616889178090641 s). Tp = 10.642241476668234 s
Sea state 19/200. (Hs, Te) = (2.6097974565855493 m, 10.607583411714911 s). Tp = 11.738563485638863 s
Sea state 20/200. (Hs, Te) = (2.7555697594812547 m, 10.323372655443912 s). Tp = 11.42405019111185 s
Sea state 21/200. (Hs, Te) = (3.682633905384873 m, 12.402475369156193 s). Tp = 13.724826744150525 s
Sea state 22/200. (Hs, Te) = (4.212665972583244 m, 12.185046415308522 s). Tp = 13.48421552486582 s
Sea state 23/200. (Hs, Te) = (4.05026799253212 m, 11.113905814149078 s). Tp = 12.298869960213526 s
Sea state 24/200. (Hs, Te) = (5.303297566743566 m, 10.639559673240361 s). Tp = 11.773949054753066 s
Sea state 25/200. (Hs, Te) = (4.924134073730911 m, 9.785109089934313 s). Tp = 10.828396988068192 s
Sea state 26/200. (Hs, Te) = (3.5985615413148957 m, 8.581846021873012 s). Tp = 9.496842064939978 s
Sea state 27/200. (Hs, Te) = (3.135645469719277 m, 7.8511911960291645 s). Tp = 8.688284853899408 s
Sea state 28/200. (Hs, Te) = (2.431810006062661 m, 7.116680274464138 s). Tp = 7.875460410382518 s
Sea state 29/200. (Hs, Te) = (2.0838410893707966 m, 6.298801092171736 s). Tp = 6.970378985868918 s
Sea state 30/200. (Hs, Te) = (1.6423455509793814 m, 6.523674804404985 s). Tp = 7.219228723348807 s
Sea state 31/200. (Hs, Te) = (1.4428843954801813 m, 7.031455517574027 s). Tp = 7.7811489936843605 s
Sea state 32/200. (Hs, Te) = (1.0660804027836115 m, 7.003369546884362 s). Tp = 7.750068498042693 s
Sea state 33/200. (Hs, Te) = (0.6706525629195497 m, 7.391577956604073 s). Tp = 8.179667671226758 s
Sea state 34/200. (Hs, Te) = (0.9453680651508931 m, 8.514256864842773 s). Tp = 9.422046554978298 s
Sea state 35/200. (Hs, Te) = (0.8606454052847035 m, 9.19445876440277 s). Tp = 10.1747715509674 s
Sea state 36/200. (Hs, Te) = (1.446046535282041 m, 9.890985020002242 s). Tp = 10.94556140511448 s
Sea state 37/200. (Hs, Te) = (1.814284454479686 m, 10.884111327310288 s). Tp = 12.044574795357422 s
Sea state 38/200. (Hs, Te) = (1.8369294990041127 m, 14.071484897068036 s). Tp = 15.571785994067179 s
Sea state 39/200. (Hs, Te) = (2.4279375035930384 m, 11.721321793811422 s). Tp = 12.971048604746592 s
Sea state 40/200. (Hs, Te) = (3.4366878484585097 m, 13.500507507743283 s). Tp = 14.939931020760929 s
Sea state 41/200. (Hs, Te) = (4.881749805564816 m, 15.102009111828629 s). Tp = 16.712184655000232 s
Sea state 42/200. (Hs, Te) = (5.929650654049805 m, 14.041374740462938 s). Tp = 15.538465493897355 s
Sea state 43/200. (Hs, Te) = (6.733647106251836 m, 12.756124450005649 s). Tp = 14.116181874349593 s
Sea state 44/200. (Hs, Te) = (5.823482465094092 m, 10.757719220728456 s). Tp = 11.904706767965251 s
Sea state 45/200. (Hs, Te) = (4.522240943762454 m, 8.448078861366799 s). Tp = 9.348812655700389 s
Sea state 46/200. (Hs, Te) = (3.9632342495762476 m, 7.763746279892604 s). Tp = 8.591516564674196 s
Sea state 47/200. (Hs, Te) = (3.48351682452572 m, 7.324368618974508 s). Tp = 8.105292476993444 s
Sea state 48/200. (Hs, Te) = (2.563456346797842 m, 6.056216781584966 s). Tp = 6.701930346822829 s
Sea state 49/200. (Hs, Te) = (1.995627635392273 m, 5.300300446310389 s). Tp = 5.865418245333961 s
Sea state 50/200. (Hs, Te) = (1.2482525200731613 m, 5.00092407195376 s). Tp = 5.534122375192174 s
Sea state 51/200. (Hs, Te) = (1.0112713778368576 m, 5.4894639018048546 s). Tp = 6.0747503000819165 s
Sea state 52/200. (Hs, Te) = (0.7225874968126063 m, 5.797180698365338 s). Tp = 6.415275847873832 s
Sea state 53/200. (Hs, Te) = (0.3412147422072267 m, 6.444682361990287 s). Tp = 7.131814110219623 s
Sea state 54/200. (Hs, Te) = (0.37629800539801495 m, 7.278127327491898 s). Tp = 8.054120941059342 s
Sea state 55/200. (Hs, Te) = (0.2593556848203602 m, 9.772429376897422 s). Tp = 10.814365364588443 s
Sea state 56/200. (Hs, Te) = (0.22439382449464995 m, 11.838773644910981 s). Tp = 13.101023167012615 s
Sea state 57/200. (Hs, Te) = (0.7231170863341507 m, 13.331652990941636 s). Tp = 14.75307324285046 s
Sea state 58/200. (Hs, Te) = (1.0944677391961881 m, 14.740489201708725 s). Tp = 16.31211950806222 s
Sea state 59/200. (Hs, Te) = (2.2544246940776325 m, 15.00832277152429 s). Tp = 16.608509481238684 s
Sea state 60/200. (Hs, Te) = (4.221697213400411 m, 15.06617516629942 s). Tp = 16.672530095784513 s
Sea state 61/200. (Hs, Te) = (0.42919942735341365 m, 14.389743813203152 s). Tp = 15.923977661756238 s
Sea state 62/200. (Hs, Te) = (0.8066477894744781 m, 14.929114433172016 s). Tp = 16.520855953356616 s
Sea state 63/200. (Hs, Te) = (2.18706772725983 m, 16.553280263601604 s). Tp = 18.31819027274999 s
Sea state 64/200. (Hs, Te) = (4.058781607387172 m, 17.104385307921103 s). Tp = 18.92805411250597 s
Sea state 65/200. (Hs, Te) = (5.280990480119309 m, 17.091896795314423 s). Tp = 18.914234075237836 s
Sea state 66/200. (Hs, Te) = (6.67877937615683 m, 15.499740904199125 s). Tp = 17.152322593471858 s
Sea state 67/200. (Hs, Te) = (6.927635065873248 m, 14.740354537612657 s). Tp = 16.31197048608619 s
Sea state 68/200. (Hs, Te) = (6.837998607790748 m, 12.158743171888053 s). Tp = 13.455107830795898 s
Sea state 69/200. (Hs, Te) = (6.515875893176208 m, 10.937669435895 s). Tp = 12.103843267109248 s
Sea state 70/200. (Hs, Te) = (5.304001413051129 m, 8.964849111642947 s). Tp = 9.92068092719158 s
Sea state 71/200. (Hs, Te) = (4.21625929476447 m, 7.632380539272374 s). Tp = 8.446144614602561 s
Sea state 72/200. (Hs, Te) = (3.90275894328102 m, 7.0180531016534715 s). Tp = 7.766317612771473 s
Sea state 73/200. (Hs, Te) = (3.092131576145537 m, 6.263479592630679 s). Tp = 6.931291509609928 s
Sea state 74/200. (Hs, Te) = (2.061691984692526 m, 5.2597539358137295 s). Tp = 5.8205486676825124 s
Sea state 75/200. (Hs, Te) = (1.7477973238002613 m, 4.952976645409529 s). Tp = 5.481062796151686 s
Sea state 76/200. (Hs, Te) = (1.188105496243663 m, 4.789426304957664 s). Tp = 5.300074725638678 s
Sea state 77/200. (Hs, Te) = (0.8909185568988089 m, 4.865417933018925 s). Tp = 5.384168577720861 s
Sea state 78/200. (Hs, Te) = (0.5868809150201082 m, 5.342702431380711 s). Tp = 5.912341128176003 s
Sea state 79/200. (Hs, Te) = (0.3249029161852639 m, 5.8652556732843655 s). Tp = 6.490608973606103 s
Sea state 80/200. (Hs, Te) = (0.19854447978643908 m, 6.682309275317205 s). Tp = 7.394776794529401 s
Sea state 81/200. (Hs, Te) = (1.1378533719939599 m, 16.29937669010103 s). Tp = 18.037215511479157 s
Sea state 82/200. (Hs, Te) = (1.7207753935819574 m, 18.18049776867239 s). Tp = 20.11890163619976 s
Sea state 83/200. (Hs, Te) = (3.045435393397856 m, 18.2722028817323 s). Tp = 20.220384344355757 s
Sea state 84/200. (Hs, Te) = (5.9410240832717705 m, 18.20434585099714 s). Tp = 20.14529240000659 s
Sea state 85/200. (Hs, Te) = (6.900385063891696 m, 16.965929376112204 s). Tp = 18.774836015374902 s
Sea state 86/200. (Hs, Te) = (7.5413039919231215 m, 16.07885944382636 s). Tp = 17.79318672616556 s
Sea state 87/200. (Hs, Te) = (8.33324739000868 m, 14.60855477544739 s). Tp = 16.16611823911159 s
Sea state 88/200. (Hs, Te) = (8.073493320987428 m, 13.666423534396822 s). Tp = 15.123537006833741 s
Sea state 89/200. (Hs, Te) = (7.742808676245161 m, 11.899449249557978 s). Tp = 13.168168001941908 s
Sea state 90/200. (Hs, Te) = (6.04122128102763 m, 9.145483011133436 s). Tp = 10.120574005051886 s
Sea state 91/200. (Hs, Te) = (5.307838900691543 m, 8.532751345737658 s). Tp = 9.44251291660773 s
Sea state 92/200. (Hs, Te) = (3.5538843391472863 m, 6.449345501593802 s). Tp = 7.1369744335613 s
Sea state 93/200. (Hs, Te) = (3.2727441707177842 m, 6.178574531557655 s). Tp = 6.837333874682727 s
Sea state 94/200. (Hs, Te) = (2.396435845611073 m, 5.2840531245047435 s). Tp = 5.847438634796415 s
Sea state 95/200. (Hs, Te) = (1.7925351881694949 m, 4.859872189983066 s). Tp = 5.378031547807942 s
Sea state 96/200. (Hs, Te) = (1.3712158702331128 m, 4.614584181856148 s). Tp = 5.106590943109626 s
Sea state 97/200. (Hs, Te) = (1.0020762104765706 m, 4.4051257091119895 s). Tp = 4.874800017270961 s
Sea state 98/200. (Hs, Te) = (0.6840846016235075 m, 4.6709868121298745 s). Tp = 5.169007219327068 s
Sea state 99/200. (Hs, Te) = (0.4400318176169047 m, 5.264806535859035 s). Tp = 5.826139975721048 s
Sea state 100/200. (Hs, Te) = (0.2950455607439133 m, 5.368907174671332 s). Tp = 5.941339820036593 s
Sea state 101/200. (Hs, Te) = (0.2538207006543258 m, 17.12463819459854 s). Tp = 18.950466361064674 s
Sea state 102/200. (Hs, Te) = (2.401827718374254 m, 19.74909028958335 s). Tp = 21.854737422273 s
Sea state 103/200. (Hs, Te) = (4.771083170894034 m, 20.076537695823838 s). Tp = 22.217097256475835 s
Sea state 104/200. (Hs, Te) = (6.672059784308026 m, 18.96224243886321 s). Tp = 20.98399588853062 s
Sea state 105/200. (Hs, Te) = (7.266218886285855 m, 18.517848875220015 s). Tp = 20.492221102798194 s
Sea state 106/200. (Hs, Te) = (8.704119700269523 m, 16.896830852172723 s). Tp = 18.698370209870912 s
Sea state 107/200. (Hs, Te) = (9.025791407684109 m, 15.924773336852542 s). Tp = 17.622671965285193 s
Sea state 108/200. (Hs, Te) = (8.335871487107436 m, 12.413322380618183 s). Tp = 13.736830263494564 s
Sea state 109/200. (Hs, Te) = (7.4617419694961065 m, 10.850802026111152 s). Tp = 12.00771405793852 s
Sea state 110/200. (Hs, Te) = (6.0882272377996465 m, 9.069127068362327 s). Tp = 10.036076995041613 s
Sea state 111/200. (Hs, Te) = (4.971882552682233 m, 7.629443455087086 s). Tp = 8.442894378631417 s
Sea state 112/200. (Hs, Te) = (3.9137147533928953 m, 6.396097294409882 s). Tp = 7.078048904883903 s
Sea state 113/200. (Hs, Te) = (3.06161156988711 m, 5.531224857642791 s). Tp = 6.120963807183185 s
Sea state 114/200. (Hs, Te) = (2.7343619821293204 m, 5.293654205328456 s). Tp = 5.85806338243266 s
Sea state 115/200. (Hs, Te) = (2.0584231261728334 m, 4.660229583463185 s). Tp = 5.157103055415991 s
Sea state 116/200. (Hs, Te) = (1.3721475288257854 m, 4.323265832156141 s). Tp = 4.784212243856746 s
Sea state 117/200. (Hs, Te) = (0.8599939026300656 m, 4.213959963822748 s). Tp = 4.663252188678921 s
Sea state 118/200. (Hs, Te) = (0.5419078120521271 m, 4.519931230768316 s). Tp = 5.001846098565626 s
Sea state 119/200. (Hs, Te) = (0.3868003926473669 m, 4.617757194340929 s). Tp = 5.110102262045115 s
Sea state 120/200. (Hs, Te) = (0.07629861562822371 m, 5.12934517057858 s). Tp = 5.676235725669164 s
Sea state 121/200. (Hs, Te) = (0.34633798237637237 m, 19.72005237767673 s). Tp = 21.822603489483953 s
Sea state 122/200. (Hs, Te) = (2.3276352644630043 m, 20.988388061461745 s). Tp = 23.22616906774459 s
Sea state 123/200. (Hs, Te) = (4.4025116313558925 m, 20.635956263518874 s). Tp = 22.836161007101737 s
Sea state 124/200. (Hs, Te) = (6.356747543266486 m, 20.26518087818985 s). Tp = 22.425853566597404 s
Sea state 125/200. (Hs, Te) = (8.350325561657009 m, 18.84467767246754 s). Tp = 20.853896371944614 s
Sea state 126/200. (Hs, Te) = (10.507095756225086 m, 16.726452821049758 s). Tp = 18.509826480609608 s
Sea state 127/200. (Hs, Te) = (10.051931328368415 m, 15.526444557776568 s). Tp = 17.181873389411972 s
Sea state 128/200. (Hs, Te) = (9.569671582265315 m, 13.484451946197973 s). Tp = 14.922163615954188 s
Sea state 129/200. (Hs, Te) = (7.670417919717313 m, 10.688834805882522 s). Tp = 11.828477899856887 s
Sea state 130/200. (Hs, Te) = (6.695773472447784 m, 9.28833992655812 s). Tp = 10.27866231847709 s
Sea state 131/200. (Hs, Te) = (5.2124365852315915 m, 7.762126130889369 s). Tp = 8.589723675455936 s
Sea state 132/200. (Hs, Te) = (4.332304023671216 m, 6.700456908860995 s). Tp = 7.414859327958517 s
Sea state 133/200. (Hs, Te) = (3.6845002818825954 m, 6.05544401874487 s). Tp = 6.701075192042921 s
Sea state 134/200. (Hs, Te) = (2.651930188462395 m, 4.882016850087267 s). Tp = 5.402537270592454 s
Sea state 135/200. (Hs, Te) = (1.761425029748757 m, 4.320829327277171 s). Tp = 4.781515958935407 s
Sea state 136/200. (Hs, Te) = (1.6715886684994976 m, 4.2515655747998595 s). Tp = 4.704867308234196 s
Sea state 137/200. (Hs, Te) = (0.982745350372394 m, 4.044748867057365 s). Tp = 4.475999812264762 s
Sea state 138/200. (Hs, Te) = (0.6319038698634393 m, 3.9844552342473887 s). Tp = 4.4092776749928495 s
Sea state 139/200. (Hs, Te) = (0.43826897160129663 m, 4.309987462686959 s). Tp = 4.769518135222388 s
Sea state 140/200. (Hs, Te) = (0.12296019879881004 m, 4.824883587782545 s). Tp = 5.339312462389205 s
Sea state 141/200. (Hs, Te) = (1.7008854788623395 m, 21.591483415345785 s). Tp = 23.893566421570075 s
Sea state 142/200. (Hs, Te) = (1.958403888846231 m, 22.399914218070567 s). Tp = 24.78819208070469 s
Sea state 143/200. (Hs, Te) = (6.654571320228031 m, 21.834806379665565 s). Tp = 24.1628324695775 s
Sea state 144/200. (Hs, Te) = (7.417015230376994 m, 22.004251917947876 s). Tp = 24.350344283652746 s
Sea state 145/200. (Hs, Te) = (10.015094697709129 m, 19.80808526300293 s). Tp = 21.920022437147782 s
Sea state 146/200. (Hs, Te) = (10.935487969680494 m, 18.194709889967456 s). Tp = 20.134629053238356 s
Sea state 147/200. (Hs, Te) = (10.740817257849123 m, 16.312190381294457 s). Tp = 18.051395397860563 s
Sea state 148/200. (Hs, Te) = (10.318979128904427 m, 13.810844960534954 s). Tp = 15.283356639035425 s
Sea state 149/200. (Hs, Te) = (8.926396179491384 m, 11.686930863038155 s). Tp = 12.932990914456232 s
Sea state 150/200. (Hs, Te) = (6.360592705852408 m, 8.544681430031973 s). Tp = 9.455714985961547 s
Sea state 151/200. (Hs, Te) = (5.079095551882201 m, 7.2036675682669244 s). Tp = 7.97172228560098 s
Sea state 152/200. (Hs, Te) = (4.139472783285571 m, 6.228329733752621 s). Tp = 6.89239397433383 s
Sea state 153/200. (Hs, Te) = (3.4483306755718233 m, 5.481984054027074 s). Tp = 6.0664729512650855 s
Sea state 154/200. (Hs, Te) = (2.8921184163756575 m, 4.935956882773301 s). Tp = 5.462228387176384 s
Sea state 155/200. (Hs, Te) = (2.1073029243263735 m, 4.3654137834767255 s). Tp = 4.830854007881896 s
Sea state 156/200. (Hs, Te) = (1.6474602839139243 m, 4.092507633924886 s). Tp = 4.528850616742159 s
Sea state 157/200. (Hs, Te) = (1.0572722867269018 m, 3.8421613140275808 s). Tp = 4.2518123832963495 s
Sea state 158/200. (Hs, Te) = (0.6406099130872815 m, 3.8713841750793403 s). Tp = 4.284150984500205 s
Sea state 159/200. (Hs, Te) = (0.4054145619344566 m, 4.049398568043829 s). Tp = 4.481145264164633 s
Sea state 160/200. (Hs, Te) = (0.04052982291891705 m, 4.528167327323754 s). Tp = 5.010960327371321 s
Sea state 161/200. (Hs, Te) = (0.9321525156202579 m, 23.34548077630066 s). Tp = 25.83457490352772 s
Sea state 162/200. (Hs, Te) = (3.967681748224935 m, 24.333091362041877 s). Tp = 26.92748448621447 s
Sea state 163/200. (Hs, Te) = (6.784028064639531 m, 23.110281041500112 s). Tp = 25.57429818341138 s
Sea state 164/200. (Hs, Te) = (9.44189240558023 m, 22.593599747148144 s). Tp = 25.002528352321065 s
Sea state 165/200. (Hs, Te) = (11.240531608432693 m, 19.575407738491727 s). Tp = 21.662536845270218 s
Sea state 166/200. (Hs, Te) = (12.004540248825101 m, 17.882918927035586 s). Tp = 19.789594951636836 s
Sea state 167/200. (Hs, Te) = (12.024225448635484 m, 16.671252728627874 s). Tp = 18.448740956776554 s
Sea state 168/200. (Hs, Te) = (11.357641718079881 m, 14.223019851712502 s). Tp = 15.739477598869739 s
Sea state 169/200. (Hs, Te) = (8.821707924875701 m, 11.009149800345794 s). Tp = 12.18294486485446 s
Sea state 170/200. (Hs, Te) = (7.106361798567036 m, 9.224265100430067 s). Tp = 10.207755837222862 s
Sea state 171/200. (Hs, Te) = (5.211295520287843 m, 7.015787616178823 s). Tp = 7.7638105813357745 s
Sea state 172/200. (Hs, Te) = (4.8195217091534825 m, 6.637986810245572 s). Tp = 7.3457286701932984 s
Sea state 173/200. (Hs, Te) = (3.3902610822019144 m, 5.164748265935532 s). Tp = 5.7154134974863275 s
Sea state 174/200. (Hs, Te) = (2.6095653202369826 m, 4.621018348933888 s). Tp = 5.113711120796454 s
Sea state 175/200. (Hs, Te) = (1.8697727603224317 m, 4.0452987797603335 s). Tp = 4.4766083566357855 s
Sea state 176/200. (Hs, Te) = (1.5454032632552606 m, 3.901895461469463 s). Tp = 4.317915382894982 s
Sea state 177/200. (Hs, Te) = (1.1162594384590447 m, 3.7807872241095453 s). Tp = 4.1838945906273315 s
Sea state 178/200. (Hs, Te) = (0.9028634682006197 m, 3.7222798357613645 s). Tp = 4.119149147122681 s
Sea state 179/200. (Hs, Te) = (0.32249025006568055 m, 3.8987959672401518 s). Tp = 4.314485420728108 s
Sea state 180/200. (Hs, Te) = (0.3250987448403442 m, 3.9671561761459007 s). Tp = 4.390134192082142 s
Sea state 181/200. (Hs, Te) = (1.0306696654071352 m, 23.938975875960722 s). Tp = 26.49134842444872 s
Sea state 182/200. (Hs, Te) = (2.603264286267793 m, 25.13838407710226 s). Tp = 27.81863747491678 s
Sea state 183/200. (Hs, Te) = (5.858754709021494 m, 25.063693808326345 s). Tp = 27.735983732989357 s
Sea state 184/200. (Hs, Te) = (10.155435864907151 m, 23.211633456341872 s). Tp = 25.686456788238267 s
Sea state 185/200. (Hs, Te) = (12.361550008947113 m, 20.139407734957956 s). Tp = 22.286670496400152 s
Sea state 186/200. (Hs, Te) = (12.732660337947125 m, 18.002340099850258 s). Tp = 19.92174880461209 s
Sea state 187/200. (Hs, Te) = (12.471212243449607 m, 16.22100142577672 s). Tp = 17.950483879941046 s
Sea state 188/200. (Hs, Te) = (11.30029974478813 m, 13.819219928253016 s). Tp = 15.292624545440956 s
Sea state 189/200. (Hs, Te) = (9.231594696755867 m, 11.08794558713383 s). Tp = 12.270141854942771 s
Sea state 190/200. (Hs, Te) = (7.4957968275525655 m, 9.146029757697058 s). Tp = 10.121179045709924 s
Sea state 191/200. (Hs, Te) = (6.174952841653434 m, 7.83613931929022 s). Tp = 8.67162814672867 s
Sea state 192/200. (Hs, Te) = (4.681623492075341 m, 6.339937017001209 s). Tp = 7.01590082118326 s
Sea state 193/200. (Hs, Te) = (3.900851734182826 m, 5.570871321782711 s). Tp = 6.164837375575169 s
Sea state 194/200. (Hs, Te) = (3.1189685428910567 m, 4.886108588584802 s). Tp = 5.407065270067518 s
Sea state 195/200. (Hs, Te) = (1.9193980219283122 m, 3.8820797075687836 s). Tp = 4.295986874190348 s
Sea state 196/200. (Hs, Te) = (1.5120152039662609 m, 3.6534201969813007 s). Tp = 4.042947696703235 s
Sea state 197/200. (Hs, Te) = (1.0490506632626337 m, 3.48025912982143 s). Tp = 3.8513242042259317 s
Sea state 198/200. (Hs, Te) = (0.5803416777834116 m, 3.454649334283839 s). Tp = 3.8229838934214713 s
Sea state 199/200. (Hs, Te) = (0.49309280206832695 m, 3.543799112476096 s). Tp = 3.9216388170193093 s
Sea state 200/200. (Hs, Te) = (0.08514972661072973 m, 3.7868424627988535 s). Tp = 4.190595438597723 s
</pre></div></div>
</div>
</section>
<section id="3.-Long-Term-Extreme-Distribution">
<h2>3. Long-Term Extreme Distribution<a class="headerlink" href="#3.-Long-Term-Extreme-Distribution" title="Permalink to this heading"></a></h2>
<p>Finally we integrate the weighted short-term extreme distributions over the entire sea state space to obtain the extreme distribution, assuming a 3-hour sea state coherence. For this we use the <code class="docutils literal notranslate"><span class="pre">loads.extreme.full_seastate_long_term_extreme</span></code> function. The integral reduces to a sum over the 200 bins of the weighted short-term extreme distributions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lte</span> <span class="o">=</span> <span class="n">extreme</span><span class="o">.</span><span class="n">full_seastate_long_term_extreme</span><span class="p">(</span><span class="n">ste_all</span><span class="p">,</span> <span class="n">sample_weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Similar to the short-term extreme functions, the output of long-term extreme function is a probability distribution (<code class="docutils literal notranslate"><span class="pre">scipy.stats.rv_continuous</span></code>). This object provides common statistical functions (PDF, CDF, PPF, etc.) and metrics (expected value, median, etc). Here, we will look at the survival function and the 100-year return level.</p>
<p>The value of the survival function at a given return level (e.g. 100-years) may be calculated using the <code class="docutils literal notranslate"><span class="pre">return_year_value</span></code> function. This gives a 100-year wave of about 11.1 meters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_st_hr</span> <span class="o">=</span> <span class="n">t_st</span><span class="o">/</span><span class="p">(</span><span class="mf">60.0</span><span class="o">*</span><span class="mf">60.0</span><span class="p">)</span>
<span class="n">t_return_yr</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">x_t</span> <span class="o">=</span> <span class="n">extreme</span><span class="o">.</span><span class="n">return_year_value</span><span class="p">(</span><span class="n">lte</span><span class="o">.</span><span class="n">ppf</span><span class="p">,</span> <span class="n">t_return_yr</span><span class="p">,</span> <span class="n">t_st_hr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;100-year elevation: </span><span class="si">{</span><span class="n">x_t</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100-year elevation: 11.139864671857818 m
</pre></div></div>
</div>
<p>Finally we plot the survival function and show the 100-year return level (dashed grey lines). The 100-year value is about 11.1 m (where the grey line intersects the x-axis)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># plot survival function</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lte</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># format plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="mf">10.0</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;elevation [m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;survival function (1-cdf)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

<span class="c1"># 100-year return level</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">s_t</span><span class="p">,</span> <span class="n">s_t</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_t</span><span class="p">,</span> <span class="n">x_t</span><span class="p">],</span> <span class="n">ylim</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x1a63e0d8460&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/extreme_response_full_sea_state_example_15_1.png" src="_images/extreme_response_full_sea_state_example_15_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="extreme_response_contour_example.html" class="btn btn-neutral float-left" title="Extreme Conditions Modeling - Contour Approach" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="short_term_extremes_example.html" class="btn btn-neutral float-right" title="MHKit Short-term Extreme Loads" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, National Renewable Energy Laboratory, Pacific Northwest National Laboratory, and Sandia National Laboratories.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-164358105-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-164358105-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>
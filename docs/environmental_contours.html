

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MHKiT Environmental Contours &mdash; MHKiT v0.5.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/mhkit.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MHKiT
          

          
          </a>

          
            
            
              <div class="version">
                v0.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="qc.html">QC Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="wave.html">Wave Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="river.html">River Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="tidal.html">Tidal Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="power.html">Power Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="loads.html">Loads Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dolfyn.html">Dolfyn Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">MHKiT-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="matlab.html">MHKiT-MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="webinars.html">Webinars</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="citeus.html">Cite Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Online Forum</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MHKiT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>MHKiT Environmental Contours</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/environmental_contours.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="MHKiT-Environmental-Contours">
<h1>MHKiT Environmental Contours<a class="headerlink" href="#MHKiT-Environmental-Contours" title="Permalink to this headline">¶</a></h1>
<p>Environmental contours of extreme sea states can be used as a part of reliability-based design for offshore structures, including wave energy converters (WECs). Environmental contours provide estimations of extreme sea states based on short-term data (e.g. 10 years used to estimate a 100-year event). These environmental contours describe extreme sea states by characterizing the resource, defining sea states for extreme condition analysis, and developing a framework for analyzing survivability of
a design.</p>
<p>MHKiT includes functions adapted from the <a class="reference external" href="https://github.com/WEC-Sim/WDRT">WDRT</a> for creating environmental contours of extreme sea states using a principal component analysis (PCA) methodology, with additional improvements for characterizing the joint probability distribution of sea states. As a demonstration, this notebook will walk through the following steps to find a 100-year sea state for NDBC buoy 46022 using 16 years of spectral wave density data.</p>
<ol class="arabic simple">
<li><p>Request Spectral Wave Density Data from NDBC</p></li>
<li><p>Calculate Hm0 and Te using the requested data</p></li>
<li><p>Find the data’s 100-year contour</p></li>
<li><p>Plot the data and the 100-year contour</p></li>
</ol>
<p>We will start by importing the necessary python packages (<code class="docutils literal notranslate"><span class="pre">scipy</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy</span></code>), and MHKiT wave submodules (<code class="docutils literal notranslate"><span class="pre">resource</span></code>, <code class="docutils literal notranslate"><span class="pre">graphics</span></code>, and <code class="docutils literal notranslate"><span class="pre">io.ndbc</span></code>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">mhkit.wave</span> <span class="kn">import</span> <span class="n">resource</span><span class="p">,</span> <span class="n">graphics</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mhkit.wave.io</span> <span class="kn">import</span> <span class="n">ndbc</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="section" id="1.-Request-Spectral-Wave-Density-Data-from-NDBC">
<h2>1. Request Spectral Wave Density Data from NDBC<a class="headerlink" href="#1.-Request-Spectral-Wave-Density-Data-from-NDBC" title="Permalink to this headline">¶</a></h2>
<p>MHKiT can be used to request historical data from the National Data Buoy Center (<a class="reference external" href="https://www.ndbc.noaa.gov/">NDBC</a>). This process is split into the following steps:</p>
<ul class="simple">
<li><p>Query available NDBC data</p></li>
<li><p>Select years of interest</p></li>
<li><p>Request Data from NDBC</p></li>
<li><p>Convert the DataFrames to DateTime Index</p></li>
</ul>
<div class="section" id="Query-available-NDBC-data">
<h3>Query available NDBC data<a class="headerlink" href="#Query-available-NDBC-data" title="Permalink to this headline">¶</a></h3>
<p>Looking at the help for the <code class="docutils literal notranslate"><span class="pre">ndbc.available_data</span></code> function (<code class="docutils literal notranslate"><span class="pre">help(ndbc.available_data)</span></code>) the function requires a parameter to be specified and optionally the user may provide a station ID as a string. We are interested in historical spectral wave density data <code class="docutils literal notranslate"><span class="pre">'swden'</span></code> (from which we may calculate Hm0 and Te). Additionally, we will specify the buoy number as <code class="docutils literal notranslate"><span class="pre">'46022'</span></code> to only return data associated with this site.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specify the parameter as spectral wave density and the buoy number to be 46022</span>
<span class="n">parameter</span> <span class="o">=</span> <span class="s1">&#39;swden&#39;</span>
<span class="n">buoy_number</span> <span class="o">=</span> <span class="s1">&#39;46022&#39;</span>
<span class="n">ndbc_available_data</span><span class="o">=</span> <span class="n">ndbc</span><span class="o">.</span><span class="n">available_data</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">buoy_number</span><span class="p">)</span>
<span class="n">ndbc_available_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>year</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1414</th>
      <td>46022</td>
      <td>1996</td>
      <td>46022w1996.txt.gz</td>
    </tr>
    <tr>
      <th>1415</th>
      <td>46022</td>
      <td>1997</td>
      <td>46022w1997.txt.gz</td>
    </tr>
    <tr>
      <th>1416</th>
      <td>46022</td>
      <td>1998</td>
      <td>46022w1998.txt.gz</td>
    </tr>
    <tr>
      <th>1417</th>
      <td>46022</td>
      <td>1999</td>
      <td>46022w1999.txt.gz</td>
    </tr>
    <tr>
      <th>1418</th>
      <td>46022</td>
      <td>2000</td>
      <td>46022w2000.txt.gz</td>
    </tr>
    <tr>
      <th>1419</th>
      <td>46022</td>
      <td>2001</td>
      <td>46022w2001.txt.gz</td>
    </tr>
    <tr>
      <th>1420</th>
      <td>46022</td>
      <td>2002</td>
      <td>46022w2002.txt.gz</td>
    </tr>
    <tr>
      <th>1421</th>
      <td>46022</td>
      <td>2003</td>
      <td>46022w2003.txt.gz</td>
    </tr>
    <tr>
      <th>1422</th>
      <td>46022</td>
      <td>2004</td>
      <td>46022w2004.txt.gz</td>
    </tr>
    <tr>
      <th>1423</th>
      <td>46022</td>
      <td>2005</td>
      <td>46022w2005.txt.gz</td>
    </tr>
    <tr>
      <th>1424</th>
      <td>46022</td>
      <td>2006</td>
      <td>46022w2006.txt.gz</td>
    </tr>
    <tr>
      <th>1425</th>
      <td>46022</td>
      <td>2007</td>
      <td>46022w2007.txt.gz</td>
    </tr>
    <tr>
      <th>1426</th>
      <td>46022</td>
      <td>2008</td>
      <td>46022w2008.txt.gz</td>
    </tr>
    <tr>
      <th>1427</th>
      <td>46022</td>
      <td>2009</td>
      <td>46022w2009.txt.gz</td>
    </tr>
    <tr>
      <th>1428</th>
      <td>46022</td>
      <td>2010</td>
      <td>46022w2010.txt.gz</td>
    </tr>
    <tr>
      <th>1429</th>
      <td>46022</td>
      <td>2011</td>
      <td>46022w2011.txt.gz</td>
    </tr>
    <tr>
      <th>1430</th>
      <td>46022</td>
      <td>2012</td>
      <td>46022w2012.txt.gz</td>
    </tr>
    <tr>
      <th>1431</th>
      <td>46022</td>
      <td>2013</td>
      <td>46022w2013.txt.gz</td>
    </tr>
    <tr>
      <th>1432</th>
      <td>46022</td>
      <td>2014</td>
      <td>46022w2014.txt.gz</td>
    </tr>
    <tr>
      <th>1433</th>
      <td>46022</td>
      <td>2015</td>
      <td>46022w2015.txt.gz</td>
    </tr>
    <tr>
      <th>1434</th>
      <td>46022</td>
      <td>2016</td>
      <td>46022w2016.txt.gz</td>
    </tr>
    <tr>
      <th>1435</th>
      <td>46022</td>
      <td>2017</td>
      <td>46022w2017.txt.gz</td>
    </tr>
    <tr>
      <th>1436</th>
      <td>46022</td>
      <td>2018</td>
      <td>46022w2018.txt.gz</td>
    </tr>
    <tr>
      <th>1437</th>
      <td>46022</td>
      <td>2019</td>
      <td>46022w2019.txt.gz</td>
    </tr>
    <tr>
      <th>1438</th>
      <td>46022</td>
      <td>2004</td>
      <td>46022wb2004.txt.gz</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Select-years-of-interest">
<h3>Select years of interest<a class="headerlink" href="#Select-years-of-interest" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ndbc.available_data</span></code> function has returned a DataFrame with columns ‘id’, ‘year’, and ‘filename’. The year column is of type int while the filename and id (5 digit alpha-numeric specifier) are of type string. In this case, the years returned from <code class="docutils literal notranslate"><span class="pre">ndbc_available_data</span></code> span 1996 to the last complete year the buoy was operational (currently 2019 for 46022). For demonstration, we have decided we are interested in the data between the years 1996 and 2012 so we will create a new
<code class="docutils literal notranslate"><span class="pre">years_of_interest</span></code> DataFrame which only contains years less than 2013.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Slice the available data to only include through year 2012</span>
<span class="n">years_of_interest</span> <span class="o">=</span> <span class="n">ndbc_available_data</span><span class="p">[</span><span class="n">ndbc_available_data</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;</span> <span class="mi">2013</span><span class="p">]</span>
<span class="n">years_of_interest</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>year</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1414</th>
      <td>46022</td>
      <td>1996</td>
      <td>46022w1996.txt.gz</td>
    </tr>
    <tr>
      <th>1415</th>
      <td>46022</td>
      <td>1997</td>
      <td>46022w1997.txt.gz</td>
    </tr>
    <tr>
      <th>1416</th>
      <td>46022</td>
      <td>1998</td>
      <td>46022w1998.txt.gz</td>
    </tr>
    <tr>
      <th>1417</th>
      <td>46022</td>
      <td>1999</td>
      <td>46022w1999.txt.gz</td>
    </tr>
    <tr>
      <th>1418</th>
      <td>46022</td>
      <td>2000</td>
      <td>46022w2000.txt.gz</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Request-Data-from-NDBC">
<h3>Request Data from NDBC<a class="headerlink" href="#Request-Data-from-NDBC" title="Permalink to this headline">¶</a></h3>
<p>The filename column in our <code class="docutils literal notranslate"><span class="pre">years_of_interest</span></code> DataFrame and the parameter is needed to request the data. To get the data we can use the <code class="docutils literal notranslate"><span class="pre">ndbc.request_data</span></code> function to iterate over each buoy id and year in the passed DataFrame. This function will return the parameter data as a dictionary of DataFrames which may be accessed by buoy id and then the year for multiple buoys or just the year for a single buoy.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get dictionary of parameter data by year</span>
<span class="n">filenames</span><span class="o">=</span> <span class="n">years_of_interest</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span>
<span class="n">ndbc_requested_data</span> <span class="o">=</span> <span class="n">ndbc</span><span class="o">.</span><span class="n">request_data</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">filenames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Convert-the-DataFrames-to-DateTime-Index">
<h3>Convert the DataFrames to DateTime Index<a class="headerlink" href="#Convert-the-DataFrames-to-DateTime-Index" title="Permalink to this headline">¶</a></h3>
<p>The data returned for each year has a variable number of columns for the year, month, day, hour, minute, and the way the columns are formatted (this is a primary reason for return a dictionary of DataFrames indexed by years). A common step a user will want to take is to remove the inconsistent NDBC date/ time columns and create a standard DateTime index. The MHKiT function <code class="docutils literal notranslate"><span class="pre">ndbc.to_datetime_index</span></code> will perform this standardization by parsing the NDBC date/ time columns into DateTime format and
setting this as the DataFrame Index and removing the NDBC date/ time columns. This function operates on a DateFrame therefore we will iterate over each year of the <code class="docutils literal notranslate"><span class="pre">ndbc_requested_data</span></code> dictionary.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Lastly we will convert a DateTime Index</span>
<span class="n">ndbc_data</span><span class="o">=</span><span class="p">{}</span>
<span class="c1"># Create a Datetime Index and remove NOAA date columns for each year</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">ndbc_requested_data</span><span class="p">:</span>
    <span class="n">year_data</span> <span class="o">=</span> <span class="n">ndbc_requested_data</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
    <span class="n">ndbc_data</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndbc</span><span class="o">.</span><span class="n">to_datetime_index</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">year_data</span><span class="p">)</span>

<span class="c1"># Display DataFrame of 46022 data from 1996</span>
<span class="n">ndbc_data</span><span class="p">[</span><span class="s1">&#39;1996&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0.03</th>
      <th>0.04</th>
      <th>0.05</th>
      <th>0.06</th>
      <th>0.07</th>
      <th>0.08</th>
      <th>0.09</th>
      <th>0.10</th>
      <th>0.11</th>
      <th>0.12</th>
      <th>...</th>
      <th>0.31</th>
      <th>0.32</th>
      <th>0.33</th>
      <th>0.34</th>
      <th>0.35</th>
      <th>0.36</th>
      <th>0.37</th>
      <th>0.38</th>
      <th>0.39</th>
      <th>0.40</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996-01-01 00:00:00</th>
      <td>0.0</td>
      <td>2.11</td>
      <td>27.49</td>
      <td>41.63</td>
      <td>27.23</td>
      <td>17.09</td>
      <td>8.61</td>
      <td>5.05</td>
      <td>3.73</td>
      <td>2.82</td>
      <td>...</td>
      <td>0.17</td>
      <td>0.16</td>
      <td>0.14</td>
      <td>0.15</td>
      <td>0.13</td>
      <td>0.09</td>
      <td>0.09</td>
      <td>0.08</td>
      <td>0.06</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>1996-01-01 01:00:00</th>
      <td>0.0</td>
      <td>1.20</td>
      <td>25.13</td>
      <td>57.69</td>
      <td>32.59</td>
      <td>11.75</td>
      <td>6.33</td>
      <td>4.16</td>
      <td>4.22</td>
      <td>2.98</td>
      <td>...</td>
      <td>0.22</td>
      <td>0.18</td>
      <td>0.20</td>
      <td>0.10</td>
      <td>0.12</td>
      <td>0.10</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>0.05</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>1996-01-01 02:00:00</th>
      <td>0.0</td>
      <td>0.90</td>
      <td>15.98</td>
      <td>48.98</td>
      <td>37.98</td>
      <td>23.56</td>
      <td>11.87</td>
      <td>6.80</td>
      <td>3.75</td>
      <td>3.00</td>
      <td>...</td>
      <td>0.14</td>
      <td>0.15</td>
      <td>0.20</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>0.07</td>
      <td>0.09</td>
      <td>0.07</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>1996-01-01 03:00:00</th>
      <td>0.0</td>
      <td>0.38</td>
      <td>14.73</td>
      <td>38.55</td>
      <td>34.99</td>
      <td>14.79</td>
      <td>9.23</td>
      <td>5.54</td>
      <td>4.43</td>
      <td>2.99</td>
      <td>...</td>
      <td>0.17</td>
      <td>0.20</td>
      <td>0.17</td>
      <td>0.14</td>
      <td>0.12</td>
      <td>0.09</td>
      <td>0.07</td>
      <td>0.05</td>
      <td>0.06</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>1996-01-01 04:00:00</th>
      <td>0.0</td>
      <td>0.12</td>
      <td>22.77</td>
      <td>52.11</td>
      <td>34.88</td>
      <td>18.90</td>
      <td>13.36</td>
      <td>7.49</td>
      <td>2.94</td>
      <td>2.55</td>
      <td>...</td>
      <td>0.12</td>
      <td>0.11</td>
      <td>0.09</td>
      <td>0.13</td>
      <td>0.10</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>0.07</td>
      <td>0.03</td>
      <td>0.03</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 38 columns</p>
</div></div>
</div>
</div>
</div>
<div class="section" id="2.-Calculate-Hm0-and-Te-using-the-NDBC-Data">
<h2>2. Calculate Hm0 and Te using the NDBC Data<a class="headerlink" href="#2.-Calculate-Hm0-and-Te-using-the-NDBC-Data" title="Permalink to this headline">¶</a></h2>
<p>A sea state may be characterized by significant wave height (Hm0) and energy period (Te). Using the historical spectral wave density data from NDBC, we can calculate these variables using MHKiT. Both Hm0 and Te return a single value for a given time (e.g. DateTime index). Currently, the data remains as a dictionary of DataFrames because the frequency binning (range and discretization) change across years of NDBC data. Once we have a single value for each DateTime we can combine all the data into
a single DataFrame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Intialize empty lists to store the results from each year</span>
<span class="n">Hm0_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">Te_list</span><span class="o">=</span><span class="p">[]</span>

<span class="c1"># Iterate over each year and save the result in the initalized dictionary</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">ndbc_data</span><span class="p">:</span>
    <span class="n">year_data</span> <span class="o">=</span> <span class="n">ndbc_data</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
    <span class="n">Hm0_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">significant_wave_height</span><span class="p">(</span><span class="n">year_data</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
    <span class="n">Te_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">energy_period</span><span class="p">(</span><span class="n">year_data</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>

<span class="c1"># Concatenate list of Series into a single DataFrame</span>
<span class="n">Te</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">Te_list</span> <span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Hm0</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">Hm0_list</span> <span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Hm0_Te</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Hm0</span><span class="p">,</span><span class="n">Te</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Drop any NaNs created from the calculation of Hm0 or Te</span>
<span class="n">Hm0_Te</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Sort the DateTime index</span>
<span class="n">Hm0_Te</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Hm0_Te</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hm0</th>
      <th>Te</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1996-01-01 00:00:00</th>
      <td>4.819627</td>
      <td>14.856398</td>
    </tr>
    <tr>
      <th>1996-01-01 01:00:00</th>
      <td>5.004158</td>
      <td>14.961679</td>
    </tr>
    <tr>
      <th>1996-01-01 02:00:00</th>
      <td>5.091169</td>
      <td>14.244618</td>
    </tr>
    <tr>
      <th>1996-01-01 03:00:00</th>
      <td>4.679487</td>
      <td>14.042246</td>
    </tr>
    <tr>
      <th>1996-01-01 04:00:00</th>
      <td>5.140895</td>
      <td>14.478961</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-12-31 19:00:00</th>
      <td>1.995194</td>
      <td>14.757854</td>
    </tr>
    <tr>
      <th>2012-12-31 20:00:00</th>
      <td>1.976259</td>
      <td>14.360242</td>
    </tr>
    <tr>
      <th>2012-12-31 21:00:00</th>
      <td>2.658421</td>
      <td>15.708162</td>
    </tr>
    <tr>
      <th>2012-12-31 22:00:00</th>
      <td>2.364910</td>
      <td>15.247587</td>
    </tr>
    <tr>
      <th>2012-12-31 23:00:00</th>
      <td>2.056891</td>
      <td>14.328179</td>
    </tr>
  </tbody>
</table>
<p>125410 rows × 2 columns</p>
</div></div>
</div>
</div>
<div class="section" id="3.-Find-the-contour-line-for-the-100-year">
<h2>3. Find the contour line for the 100 year<a class="headerlink" href="#3.-Find-the-contour-line-for-the-100-year" title="Permalink to this headline">¶</a></h2>
<p>With the sea state data calculated, we can now use the modified I-FORM method to define reliability for a 100-year sea state based on the 17 years of spectral wave density data obtained from NDBC for buoy 46022. Reliability is the likelihood that a certain event will not occur in a given period. The period will define a line of constant probability in the joint probability of Hm0 and Te but individually each component different reliability (marginal distribution) which we can find by evaluating
a normal cumulative distribution function (CDF). This CDF returns each component’s quantiles along the iso-reliability line that finally allows us to calculate each sea state value (e.g. the 100-year contour values for Hm0 and Te).</p>
<p>For more detail on the environmental contour method used here please refer to: <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0029801815006721">Eckert-Gallup et. al 2016</a></p>
<p>To apply the environmental contours function we will specify a 100-year sea state, the sea state data (Hm0, Te), and the time difference between measurements (dt in seconds).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Return period (years) of interest</span>
<span class="n">period</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Remove Hm0 Outliers</span>
<span class="n">Hm0_Te_clean</span> <span class="o">=</span> <span class="n">Hm0_Te</span><span class="p">[</span><span class="n">Hm0_Te</span><span class="o">.</span><span class="n">Hm0</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">]</span>

<span class="c1"># Get only the values from the DataFrame</span>
<span class="n">Hm0</span> <span class="o">=</span> <span class="n">Hm0_Te_clean</span><span class="o">.</span><span class="n">Hm0</span><span class="o">.</span><span class="n">values</span>
<span class="n">Te</span>  <span class="o">=</span> <span class="n">Hm0_Te_clean</span><span class="o">.</span><span class="n">Te</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Delta time of sea-states</span>
<span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">Hm0_Te_clean</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">Hm0_Te_clean</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">seconds</span>

<span class="c1"># Get the contour values</span>
<span class="n">Hm0_contour</span><span class="p">,</span> <span class="n">Te_contour</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">environmental_contour</span><span class="p">(</span><span class="n">Hm0</span><span class="p">,</span> <span class="n">Te</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="4.-Plot-overlay-of-the-data-and-contour">
<h2>4. Plot overlay of the data and contour<a class="headerlink" href="#4.-Plot-overlay-of-the-data-and-contour" title="Permalink to this headline">¶</a></h2>
<p>Lastly we can use the MHKiT graphics module to create a contour plot which shows the data and resultant conotour line.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">graphics</span><span class="o">.</span><span class="n">plot_environmental_contour</span><span class="p">(</span><span class="n">Te</span><span class="p">,</span> <span class="n">Hm0</span><span class="p">,</span>
                                    <span class="n">Te_contour</span><span class="p">,</span> <span class="n">Hm0_contour</span><span class="p">,</span>
                                    <span class="n">data_label</span><span class="o">=</span><span class="s1">&#39;NDBC 46022&#39;</span><span class="p">,</span>
                                    <span class="n">contour_label</span><span class="o">=</span><span class="s1">&#39;100 Year Contour&#39;</span><span class="p">,</span>
                                    <span class="n">x_label</span> <span class="o">=</span> <span class="s1">&#39;Energy Period, $Te$ [s]&#39;</span><span class="p">,</span>
                                    <span class="n">y_label</span> <span class="o">=</span> <span class="s1">&#39;Sig. wave height, $Hm0$ [m]&#39;</span><span class="p">,</span>
                                    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/environmental_contours_15_0.png" src="_images/environmental_contours_15_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, National Renewable Energy Laboratory, Pacific Northwest National Laboratory, and Sandia National Laboratories

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-164358105-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>
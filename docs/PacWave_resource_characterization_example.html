<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PacWave Resource Assessment &mdash; MHKiT v0.8.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/mhkit.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=b3dab91b"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MHKiT
          </a>
              <div class="version">
                v0.8.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">MHKiT-Python Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="matlab_installation.html">MHKiT-MATLAB Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="module.html">Module Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="webinars.html">Webinars</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="citeus.html">Cite Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Online Forum</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MHKiT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">PacWave Resource Assessment</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/PacWave_resource_characterization_example.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="PacWave-Resource-Assessment">
<h1>PacWave Resource Assessment<a class="headerlink" href="#PacWave-Resource-Assessment" title="Link to this heading"></a></h1>
<p>This example notebook provides an example using MHKiT to perform a resource assessment similar to Dunkel et. al at the PACWAVE site following the IEC 62600-101 where applicable. PacWave is an open ocean, grid-connected, full-scale test facility consisting of two sites (PacWave-North &amp; PacWave-South) for wave energy conversion technology testing located just a few miles from the deep-water port of Newport, Oregon. This example notebook performs a resource analysis using omni-directional wave data
from a nearby NDBC buoy and replicates plots created by Dunkel et. al and prescribed by IEC TS 62600-101 using these data.</p>
<p>Note: this example notebook requires the Python package folium which is not a requirement of MHKiT and may need to be pip installed seperately.</p>
<p>Dunkle, Gabrielle, et al. “PacWave Wave Resource Assessment.” (2020).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import mhkit
from mhkit.wave import resource, performance, graphics, contours
from sklearn.mixture import GaussianMixture
from mhkit.wave.io import ndbc
import matplotlib.pyplot as plt
from matplotlib import colors
from scipy import stats
import pandas as pd
import numpy as np
import folium
import os

import matplotlib.pylab as pylab

params = {
    &quot;legend.fontsize&quot;: &quot;x-large&quot;,
    &quot;figure.figsize&quot;: (15, 5),
    &quot;axes.labelsize&quot;: &quot;x-large&quot;,
    &quot;axes.titlesize&quot;: &quot;x-large&quot;,
    &quot;xtick.labelsize&quot;: &quot;x-large&quot;,
    &quot;ytick.labelsize&quot;: &quot;x-large&quot;,
}
pylab.rcParams.update(params)
</pre></div>
</div>
</div>
<section id="Buoy-Location">
<h2>Buoy Location<a class="headerlink" href="#Buoy-Location" title="Link to this heading"></a></h2>
<p>The closest NDBC buoy to PacWave is located further from shore than the PacWave sites, as can be seen in the map below. The buoy used in this analysis is NDBC buoy 46050 (blue marker). The analysis here will focus on PacWave-South (red marker) which is approximately 40 km closer to shore than the NDBC buoy. PacWave-North is shown by the green marker.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>m = folium.Map(
    location=[44.613600975457715, -123.74317583354498],
    zoom_start=9,
    tiles=&quot;Stamen Terrain&quot;,
    control_scale=True,
)

tooltip = &quot;NDBC 46050&quot;
folium.Marker(
    [44.669, -124.546], popup=&quot;&lt;i&gt; Water depth: 160 m&lt;/i&gt;&quot;, tooltip=tooltip
).add_to(m)

tooltip = &quot;PACWAVE North&quot;
folium.Marker(
    [44.69, -124.13472222222222],
    tooltip=tooltip,
    icon=folium.Icon(color=&quot;green&quot;, icon=&quot;th-large&quot;),
).add_to(m)
tooltip = &quot;PACWAVE South&quot;
folium.Marker(
    [44.58444444444444, -124.2125],
    tooltip=tooltip,
    icon=folium.Icon(color=&quot;red&quot;, icon=&quot;th&quot;),
).add_to(m)

m.save(&quot;index.png&quot;)

m
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;

    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

        &lt;script&gt;
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        &lt;/script&gt;

    &lt;style&gt;html, body {width: 100%;height: 100%;margin: 0;padding: 0;}&lt;/style&gt;
    &lt;style&gt;#map {position:absolute;top:0;bottom:0;right:0;left:0;}&lt;/style&gt;
    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://code.jquery.com/jquery-1.12.4.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;

            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;
            &lt;style&gt;
                #map_58cb4f9f294a0c3231ff7d56e165e79b {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
            &lt;/style&gt;

&lt;/head&gt;
&lt;body&gt;


            &lt;div class=&quot;folium-map&quot; id=&quot;map_58cb4f9f294a0c3231ff7d56e165e79b&quot; &gt;&lt;/div&gt;

&lt;/body&gt;
&lt;script&gt;


            var map_58cb4f9f294a0c3231ff7d56e165e79b = L.map(
                &quot;map_58cb4f9f294a0c3231ff7d56e165e79b&quot;,
                {
                    center: [44.613600975457715, -123.74317583354498],
                    crs: L.CRS.EPSG3857,
                    zoom: 9,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );
            L.control.scale().addTo(map_58cb4f9f294a0c3231ff7d56e165e79b);





            var tile_layer_f31d94f73f6f9ab9f3f3f76f895994fe = L.tileLayer(
                &quot;https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg&quot;,
                {&quot;attribution&quot;: &quot;Map tiles by \u003ca href=\&quot;http://stamen.com\&quot;\u003eStamen Design\u003c/a\u003e, under \u003ca href=\&quot;http://creativecommons.org/licenses/by/3.0\&quot;\u003eCC BY 3.0\u003c/a\u003e. Data by \u0026copy; \u003ca href=\&quot;http://openstreetmap.org\&quot;\u003eOpenStreetMap\u003c/a\u003e, under \u003ca href=\&quot;http://creativecommons.org/licenses/by-sa/3.0\&quot;\u003eCC BY SA\u003c/a\u003e.&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 18, &quot;maxZoom&quot;: 18, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            ).addTo(map_58cb4f9f294a0c3231ff7d56e165e79b);


            var marker_9fe23c280cf5f44255a9bc87cc815ea2 = L.marker(
                [44.669, -124.546],
                {}
            ).addTo(map_58cb4f9f294a0c3231ff7d56e165e79b);


        var popup_bf1a0ce6605844444953196a9038ceb7 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});



                var html_bcf2c34b7edbd9ed7e13c59b0481d5fe = $(`&lt;div id=&quot;html_bcf2c34b7edbd9ed7e13c59b0481d5fe&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;&lt;i&gt; Water depth: 160 m&lt;/i&gt;&lt;/div&gt;`)[0];
                popup_bf1a0ce6605844444953196a9038ceb7.setContent(html_bcf2c34b7edbd9ed7e13c59b0481d5fe);



        marker_9fe23c280cf5f44255a9bc87cc815ea2.bindPopup(popup_bf1a0ce6605844444953196a9038ceb7)
        ;




            marker_9fe23c280cf5f44255a9bc87cc815ea2.bindTooltip(
                `&lt;div&gt;
                     NDBC 46050
                 &lt;/div&gt;`,
                {&quot;sticky&quot;: true}
            );


            var marker_dbf93bfb4a96f69d1bcb47bccb537f9d = L.marker(
                [44.69, -124.13472222222222],
                {}
            ).addTo(map_58cb4f9f294a0c3231ff7d56e165e79b);


            var icon_0c2eaf89570a7b0a0015736640bb6c30 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;th-large&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_dbf93bfb4a96f69d1bcb47bccb537f9d.setIcon(icon_0c2eaf89570a7b0a0015736640bb6c30);


            marker_dbf93bfb4a96f69d1bcb47bccb537f9d.bindTooltip(
                `&lt;div&gt;
                     PACWAVE North
                 &lt;/div&gt;`,
                {&quot;sticky&quot;: true}
            );


            var marker_a28c6fbe737d1fd915c28319f03c7e24 = L.marker(
                [44.58444444444444, -124.2125],
                {}
            ).addTo(map_58cb4f9f294a0c3231ff7d56e165e79b);


            var icon_d8fc1820cc37d4bc9287b0ae41bfe264 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;th&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a28c6fbe737d1fd915c28319f03c7e24.setIcon(icon_d8fc1820cc37d4bc9287b0ae41bfe264);


            marker_a28c6fbe737d1fd915c28319f03c7e24.bindTooltip(
                `&lt;div&gt;
                     PACWAVE South
                 &lt;/div&gt;`,
                {&quot;sticky&quot;: true}
            );

&lt;/script&gt;
&lt;/html&gt;" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div></div>
</div>
</section>
<section id="Bouy-Metadata">
<h2>Bouy Metadata<a class="headerlink" href="#Bouy-Metadata" title="Link to this heading"></a></h2>
<p>The MHKiT function <code class="docutils literal notranslate"><span class="pre">get_buoy_metadata</span></code> will fetch the metadata for a given National Data Buoy Center (NDBC) buoy. In this case the station number nearest to PACWAVE is ‘46050’. This metadata can provide important background information about the buoy to help users understand the source of the data they are working with and ensure that the buoy’s location and characteristics are suitable for their specific analysis. Note that optional buoy keys will be assigned as metadata keys with empty
values. This can be seen in the example below for “SCOOP Payload”.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Get buoy metadata
buoy_number = &quot;46050&quot;
buoy_metadata = ndbc.get_buoy_metadata(buoy_number)
print(&quot;Buoy Metadata:&quot;)
for key, value in buoy_metadata.items():
    print(f&quot;{key}: {value}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Buoy Metadata:
buoy: Station 46050(LLNR 641)- STONEWALL BANK - 20NM West of Newport, OR
provider: Owned and maintained by National Data Buoy Center
type: 3-meter discus buoy w/ seal cage
SCOOP payload:
lat: 44.669
lon: 124.546
Site elevation: sea level
Air temp height: 3.7 m above site elevation
Anemometer height: 4.1 m above site elevation
Barometer elevation: 2.7 m above mean sea level
Sea temp depth: 1.5 m below water line
Water depth: 160 m
Watch circle radius: 243 yards
</pre></div></div>
</div>
</section>
<section id="Import-Data-from-NDBC">
<h2>Import Data from NDBC<a class="headerlink" href="#Import-Data-from-NDBC" title="Link to this heading"></a></h2>
<p>NDBC buoy data can be imported using MHKiT’s NDBC submodule. At the top of this script, we have already imported this module using the call <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mhkit.wave.io</span> <span class="pre">import</span> <span class="pre">ndbc</span></code>. Here, we will use the <code class="docutils literal notranslate"><span class="pre">available_data</span></code> function to ask the NDBC servers what data is available for buoy 46050. We will also need to specify what parameter we are interested in. In this case, we are requesting wave spectral wave density data for which NDBC uses the keyword ‘sweden’. We then pass the data of interest using
the filenames of the returned data into the <code class="docutils literal notranslate"><span class="pre">request_data</span></code> function to retrieve the requested data from the NDBC servers.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Spectral wave density for buoy 46050
parameter = &quot;swden&quot;


# Request list of available files
ndbc_available_data = ndbc.available_data(parameter, buoy_number)

# Pass file names to NDBC and request the data
filenames = ndbc_available_data[&quot;filename&quot;]
ndbc_requested_data = ndbc.request_data(parameter, filenames)

ndbc_requested_data[&quot;2020&quot;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>#YY</th>
      <th>MM</th>
      <th>DD</th>
      <th>hh</th>
      <th>mm</th>
      <th>.0200</th>
      <th>.0325</th>
      <th>.0375</th>
      <th>.0425</th>
      <th>.0475</th>
      <th>...</th>
      <th>.3300</th>
      <th>.3400</th>
      <th>.3500</th>
      <th>.3650</th>
      <th>.3850</th>
      <th>.4050</th>
      <th>.4250</th>
      <th>.4450</th>
      <th>.4650</th>
      <th>.4850</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>2.28</td>
      <td>2.99</td>
      <td>...</td>
      <td>0.19</td>
      <td>0.22</td>
      <td>0.15</td>
      <td>0.12</td>
      <td>0.12</td>
      <td>0.06</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.37</td>
      <td>3.30</td>
      <td>3.12</td>
      <td>...</td>
      <td>0.20</td>
      <td>0.15</td>
      <td>0.14</td>
      <td>0.14</td>
      <td>0.07</td>
      <td>0.05</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>0.03</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>4.80</td>
      <td>5.16</td>
      <td>...</td>
      <td>0.07</td>
      <td>0.18</td>
      <td>0.14</td>
      <td>0.10</td>
      <td>0.13</td>
      <td>0.08</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.70</td>
      <td>1.38</td>
      <td>...</td>
      <td>0.30</td>
      <td>0.14</td>
      <td>0.11</td>
      <td>0.08</td>
      <td>0.10</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.01</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.24</td>
      <td>5.72</td>
      <td>7.90</td>
      <td>...</td>
      <td>0.12</td>
      <td>0.18</td>
      <td>0.07</td>
      <td>0.10</td>
      <td>0.12</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8616</th>
      <td>2020</td>
      <td>12</td>
      <td>31</td>
      <td>19</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.11</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>8617</th>
      <td>2020</td>
      <td>12</td>
      <td>31</td>
      <td>20</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.99</td>
      <td>...</td>
      <td>0.07</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.05</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>8618</th>
      <td>2020</td>
      <td>12</td>
      <td>31</td>
      <td>21</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>...</td>
      <td>0.05</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>8619</th>
      <td>2020</td>
      <td>12</td>
      <td>31</td>
      <td>22</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.93</td>
      <td>...</td>
      <td>0.10</td>
      <td>0.09</td>
      <td>0.09</td>
      <td>0.10</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>8620</th>
      <td>2020</td>
      <td>12</td>
      <td>31</td>
      <td>23</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.02</td>
      <td>0.39</td>
      <td>...</td>
      <td>0.14</td>
      <td>0.05</td>
      <td>0.11</td>
      <td>0.08</td>
      <td>0.04</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>
<p>8621 rows × 52 columns</p>
</div></div>
</div>
<section id="Create-DateTime-index">
<h3>Create DateTime index<a class="headerlink" href="#Create-DateTime-index" title="Link to this heading"></a></h3>
<p>The data returned from NDBC include separate columns for year, month, day, etc. as shown above. MHKiT has a built-in function to convert these separate columns into a DateTime index for the DataFrame and remove these date ant time columns from the data leaving only the frequency data. The resultant DataFrame is shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ndbc_data = {}
# Create a Datetime Index and remove NOAA date columns for each year
for year in ndbc_requested_data:
    year_data = ndbc_requested_data[year]
    ndbc_data[year] = ndbc.to_datetime_index(parameter, year_data)

ndbc_data[&quot;2020&quot;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0.0200</th>
      <th>0.0325</th>
      <th>0.0375</th>
      <th>0.0425</th>
      <th>0.0475</th>
      <th>0.0525</th>
      <th>0.0575</th>
      <th>0.0625</th>
      <th>0.0675</th>
      <th>0.0725</th>
      <th>...</th>
      <th>0.3300</th>
      <th>0.3400</th>
      <th>0.3500</th>
      <th>0.3650</th>
      <th>0.3850</th>
      <th>0.4050</th>
      <th>0.4250</th>
      <th>0.4450</th>
      <th>0.4650</th>
      <th>0.4850</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>2.28</td>
      <td>2.99</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2.91</td>
      <td>7.23</td>
      <td>10.65</td>
      <td>...</td>
      <td>0.19</td>
      <td>0.22</td>
      <td>0.15</td>
      <td>0.12</td>
      <td>0.12</td>
      <td>0.06</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>2020-01-01 01:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.37</td>
      <td>3.30</td>
      <td>3.12</td>
      <td>0.94</td>
      <td>1.49</td>
      <td>3.13</td>
      <td>8.58</td>
      <td>12.09</td>
      <td>...</td>
      <td>0.20</td>
      <td>0.15</td>
      <td>0.14</td>
      <td>0.14</td>
      <td>0.07</td>
      <td>0.05</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>0.03</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2020-01-01 02:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>4.80</td>
      <td>5.16</td>
      <td>0.66</td>
      <td>1.44</td>
      <td>4.19</td>
      <td>14.32</td>
      <td>26.21</td>
      <td>...</td>
      <td>0.07</td>
      <td>0.18</td>
      <td>0.14</td>
      <td>0.10</td>
      <td>0.13</td>
      <td>0.08</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2020-01-01 03:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.70</td>
      <td>1.38</td>
      <td>0.00</td>
      <td>0.47</td>
      <td>2.91</td>
      <td>15.89</td>
      <td>32.12</td>
      <td>...</td>
      <td>0.30</td>
      <td>0.14</td>
      <td>0.11</td>
      <td>0.08</td>
      <td>0.10</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.01</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>2020-01-01 04:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.24</td>
      <td>5.72</td>
      <td>7.90</td>
      <td>2.75</td>
      <td>0.59</td>
      <td>4.39</td>
      <td>17.49</td>
      <td>18.75</td>
      <td>...</td>
      <td>0.12</td>
      <td>0.18</td>
      <td>0.07</td>
      <td>0.10</td>
      <td>0.12</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020-12-31 19:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>6.15</td>
      <td>21.06</td>
      <td>28.97</td>
      <td>21.23</td>
      <td>20.75</td>
      <td>...</td>
      <td>0.11</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2020-12-31 20:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.99</td>
      <td>5.20</td>
      <td>21.62</td>
      <td>26.23</td>
      <td>27.02</td>
      <td>32.43</td>
      <td>...</td>
      <td>0.07</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.05</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2020-12-31 21:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.58</td>
      <td>6.02</td>
      <td>21.26</td>
      <td>18.66</td>
      <td>13.60</td>
      <td>...</td>
      <td>0.05</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2020-12-31 22:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.93</td>
      <td>3.01</td>
      <td>6.65</td>
      <td>8.73</td>
      <td>12.84</td>
      <td>27.10</td>
      <td>...</td>
      <td>0.10</td>
      <td>0.09</td>
      <td>0.09</td>
      <td>0.10</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2020-12-31 23:40:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.02</td>
      <td>0.39</td>
      <td>1.20</td>
      <td>6.47</td>
      <td>18.29</td>
      <td>23.32</td>
      <td>18.16</td>
      <td>...</td>
      <td>0.14</td>
      <td>0.05</td>
      <td>0.11</td>
      <td>0.08</td>
      <td>0.04</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>
<p>8621 rows × 47 columns</p>
</div></div>
</div>
</section>
</section>
<section id="Calculate-QoIs-from-Spectral-Data">
<h2>Calculate QoIs from Spectral Data<a class="headerlink" href="#Calculate-QoIs-from-Spectral-Data" title="Link to this heading"></a></h2>
<p>Here we will calculate quantities of interest (QoIs) using the spectral data by applying the appropriate MHKiT function, appending the results to a list, then combining all the lists into a single DataFrame.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Intialize empty lists to store the results from each year
Hm0_list = []
Te_list = []
J_list = []
Tp_list = []
Tz_list = []

# Iterate over each year and save the result in the initalized dictionary
for year in ndbc_data:
    data_raw = ndbc_data[year]
    year_data = data_raw[data_raw != 999.0].dropna()
    Hm0_list.append(resource.significant_wave_height(year_data.T))
    Te_list.append(resource.energy_period(year_data.T))
    J_list.append(resource.energy_flux(year_data.T, h=399.0))
    Tp_list.append(resource.peak_period(year_data.T))
    Tz_list.append(resource.average_zero_crossing_period(year_data.T))

# Concatenate list of Series into a single DataFrame
Te = pd.concat(Te_list, axis=0)
Tp = pd.concat(Tp_list, axis=0)
Hm0 = pd.concat(Hm0_list, axis=0)
J = pd.concat(J_list, axis=0)
Tz = pd.concat(Tz_list, axis=0)
data = pd.concat([Hm0, Te, Tp, J, Tz], axis=1)

# Calculate wave steepness
data[&quot;Sm&quot;] = data.Hm0 / (9.81 / (2 * np.pi) * data.Tz**2)

# Drop any NaNs created from the calculation of Hm0 or Te
data.dropna(inplace=True)
# Sort the DateTime index
data.sort_index(inplace=True)
# data
</pre></div>
</div>
</div>
</section>
<section id="Average-Annual-Energy-Table">
<h2>Average Annual Energy Table<a class="headerlink" href="#Average-Annual-Energy-Table" title="Link to this heading"></a></h2>
<p>A comparison of where a resource’s most energetic sea states are compared with how frequently they occur can be performed using the <code class="docutils literal notranslate"><span class="pre">plot_avg_annual_energy_matrix</span></code> function. For a given set of data, the function will bin the data by Hm0 and Te. Within each bin, the average annual power and avg number of hours are calculated. A contour of the average annual power is plotted in each bin and the average number of hours that sea state occurs is plotted as text in the box.</p>
<p>The figure below shows that the most frequent sea state occurs on average 527 hours per year at an energy period of 7.5 s and a significant wave height of 1.25 m. Dunkle et al. reported a similar most frequent sea state with a slightly longer energy period at 8.5 s and having a 1.75-m wave height for 528 hours per year. The highest average annual energy sea state at buoy 46050 occurs at an energy period of 9.5 s and a significant wave height of 2.75 m and occurs on average for 168 hours per
year. Further, Dunkle et al. reported the most energetic sea state on average to occur at 2.75 m and 10.5 s for 231 hours per year.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Start by cleaning the data of outliers
data_clean = data[data.Hm0 &lt; 20]
sigma = data_clean.J.std()
data_clean = data_clean[data_clean.J &gt; (data_clean.J.mean() - 0.9 * sigma)]

# Organizing the cleaned data
Hm0 = data_clean.Hm0
Te = data_clean.Te
J = data_clean.J

# Setting the bins for the resource frequency and power distribution
Hm0_bin_size = 0.5
Hm0_edges = np.arange(0, 15 + Hm0_bin_size, Hm0_bin_size)
Te_bin_size = 1
Te_edges = np.arange(0, 20 + Te_bin_size, Te_bin_size)

fig = mhkit.wave.graphics.plot_avg_annual_energy_matrix(
    Hm0, Te, J, Hm0_edges=Hm0_edges, Te_edges=Te_edges
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PacWave_resource_characterization_example_13_0.png" src="_images/PacWave_resource_characterization_example_13_0.png" />
</div>
</div>
</section>
<section id="Wave-Power-by-Month">
<h2>Wave Power by Month<a class="headerlink" href="#Wave-Power-by-Month" title="Link to this heading"></a></h2>
<p>We can create a plot of monthly statistics for a quantity of interest as shown in the code and plots below. These plots show the median value of a month over the dataset timeframe and bound the value by its 25th and 75th percentile by a shaded region.</p>
<p>Comparing the plots below to the analysis performed by Dunkle et. al we can see that in the top subplot the significant wave height has a maximum mean value in December at 3.11 m, which corresponds well with Fig. 5 in Dunkel et. al. The higher significant wave height also brings higher variability in the winter months than in the summer months, which shows a minimum value around 1.44 m in August. The second and third subplots below show an energy period and peak period each having a maximum
value in January at 10.3 s and 12.5 s, respectively. The minimums also correspond to the same month of July with values of 7.12 s, and 8.33 s for the energy period and peak period, respectively. Dunkle et al. report a minimum energy period value of 8.5 s in July and a maximum energy period of 11.3 s in February and do not report peak period monthly statistics.</p>
<p>The maximum energy flux occurs in December at 48889 kW/m while the minimum occurs in August at 7212 kW/m. These values come in lower than the results from Dunkel et. al., which report values ranging between 70 and 80 kW/m in the winter months and a mean around 20 kW/m in the summer months. The average monthly steepness stays relatively constant throughout the year, ranging between 0.0265 and 0.0313. A discussion of monthly wave steepness was not held in Dunkel et. al but would be interesting to
compare for the PACWAVE-South site.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>months = data_clean.index.month
data_group = data_clean.groupby(months)

QoIs = data_clean.keys()
fig, axs = plt.subplots(len(QoIs), 1, figsize=(8, 12), sharex=True)
# shade between 25% and 75%
QoIs = data_clean.keys()
for i in range(len(QoIs)):
    QoI = QoIs[i]
    axs[i].plot(data_group.median()[QoI], marker=&quot;.&quot;)

    axs[i].fill_between(
        months.unique(),
        data_group.describe()[QoI, &quot;25%&quot;],
        data_group.describe()[QoI, &quot;75%&quot;],
        alpha=0.2,
    )
    axs[i].grid()
    mx = data_group.median()[QoI].max()
    mx_month = data_group.median()[QoI].argmax() + 1
    mn = data_group.median()[QoI].min()
    mn_month = data_group.median()[QoI].argmin() + 1
    print(&quot;--------------------------------------------&quot;)
    print(f&quot;{QoI} max:{np.round(mx,4)}, month: {mx_month}&quot;)
    print(f&quot;{QoI} min:{np.round(mn,4)}, month: {mn_month}&quot;)

plt.setp(axs[5], xlabel=&quot;Month&quot;)

plt.setp(axs[0], ylabel=f&quot;{QoIs[0]} [m]&quot;)
plt.setp(axs[1], ylabel=f&quot;{QoIs[1]}  [s]&quot;)
plt.setp(axs[2], ylabel=f&quot;{QoIs[2]}  [s]&quot;)
plt.setp(axs[3], ylabel=f&quot;{QoIs[3]}  [kW/M]&quot;)
plt.setp(axs[4], ylabel=f&quot;{QoIs[4]}  [s]&quot;)
plt.setp(axs[5], ylabel=f&quot;{QoIs[5]}  [ ]&quot;)


plt.tight_layout()

plt.savefig(&quot;40650QoIs.png&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--------------------------------------------
Hm0 max:3.089, month: 12
Hm0 min:1.4479, month: 8
--------------------------------------------
Te max:10.347, month: 1
Te min:7.1092, month: 7
--------------------------------------------
Tp max:12.5, month: 1
Tp min:8.3333, month: 7
--------------------------------------------
J max:47388.6104, month: 12
J min:7286.2664, month: 8
--------------------------------------------
Tz max:8.0165, month: 1
Tz min:5.7097, month: 7
--------------------------------------------
Sm max:0.0317, month: 12
Sm min:0.0264, month: 9
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PacWave_resource_characterization_example_15_1.png" src="_images/PacWave_resource_characterization_example_15_1.png" />
</div>
</div>
</section>
<section id="Monthly-Cumulative-Distribution">
<h2>Monthly Cumulative Distribution<a class="headerlink" href="#Monthly-Cumulative-Distribution" title="Link to this heading"></a></h2>
<p>A cumulative distribution of the energy flux, as described in the IEC TS 62600-101 is created using MHKiT as shown below. The summer months have a lower maximum energy flux and are found left of the black data line representing the cumulative distribution of all collected data. April and October most closely follow the overall energy flux distribution while the winter months show less variation than the summer months in their distribution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ax = graphics.monthly_cumulative_distribution(data_clean.J)
plt.xlim([1000, 1e6])
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1000, 1000000.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PacWave_resource_characterization_example_17_1.png" src="_images/PacWave_resource_characterization_example_17_1.png" />
</div>
</div>
</section>
<section id="Extreme-Sea-States">
<h2>Extreme Sea States<a class="headerlink" href="#Extreme-Sea-States" title="Link to this heading"></a></h2>
<p>Fifty and one-hundred year contours were created using the environmental contours functions. The environmental contours function in MHKiT was adapted from the Wave Energy Converter Design Response Toolbox (WDRT) [Coe et. al, 2016]. The methodologies for calculating environmental contours are an active area of research and differences in methodology can be seen when comparing to the results. Dunkle et al. present 16.68 s and 12.49 m as the peak energy period and significant wave height for the
50-year contour, whereas the methodology applied in MHKiT returns a 50-year peak at 15.71 m and 16.24 s. Dunkle et al. present a peak for the 100-year contour at 13.19 m and 16.85 s, whereas the MHKiT functionality returns 16.62 m and 16.43 s.</p>
<p>Coe, Ryan, Michelen, Carlos, Eckert-Gallup, Aubrey, Yu, Yi-Hsiang, and Van Rij, Jennifer. (2016, March 30). WEC Design Response Toolbox v. 1.0 (Version 00) [Computer software]. <a class="reference external" href="https://www.osti.gov//servlets/purl/1312743">https://www.osti.gov//servlets/purl/1312743</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Delta time of sea-states
dt = (data_clean.index[2] - data_clean.index[1]).seconds

# Return period (years) of interest
period = 100
copulas100 = contours.environmental_contours(
    data.Hm0,
    data.Te,
    dt,
    period,
    method=&quot;PCA&quot;,
)

period = 50
copulas50 = contours.environmental_contours(
    data.Hm0,
    data.Te,
    dt,
    period,
    method=&quot;PCA&quot;,
)


Te_data = np.array(data_clean.Te)
Hm0_data = np.array(data_clean.Hm0)

Hm0_contours = [copulas50[&quot;PCA_x1&quot;], copulas100[&quot;PCA_x1&quot;]]
Te_contours = [copulas50[&quot;PCA_x2&quot;], copulas100[&quot;PCA_x2&quot;]]

fig, ax = plt.subplots(figsize=(9, 4))
ax = graphics.plot_environmental_contour(
    Te_data,
    Hm0_data,
    Te_contours,
    Hm0_contours,
    data_label=&quot;NDBC 46050&quot;,
    contour_label=[&quot;50 Year Contour&quot;, &quot;100 Year Contour&quot;],
    x_label=&quot;Energy Period, $Te$ [s]&quot;,
    y_label=&quot;Sig. wave height, $Hm0$ [m]&quot;,
    ax=ax,
)
plt.legend(loc=&quot;upper left&quot;)
plt.tight_layout()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PacWave_resource_characterization_example_19_0.png" src="_images/PacWave_resource_characterization_example_19_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(f&quot;50-year: Hm0 max {copulas50[&#39;PCA_x1&#39;].max().round(1)}&quot;)
print(
    f&quot;50-year: Te at Hm0 max {copulas50[&#39;PCA_x2&#39;][copulas50[&#39;PCA_x1&#39;].argmax()].round(1)}&quot;
)
print(&quot;\n&quot;)
print(f&quot;100-year: Hm0 max {copulas100[&#39;PCA_x1&#39;].max().round(1)}&quot;)
print(
    f&quot;100-year: Te at Hm0 max { copulas100[&#39;PCA_x2&#39;][copulas100[&#39;PCA_x1&#39;].argmax()].round(1)}&quot;
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
50-year: Hm0 max 15.7
50-year: Te at Hm0 max 16.1


100-year: Hm0 max 16.6
100-year: Te at Hm0 max 16.3
</pre></div></div>
</div>
</section>
<section id="Calculate-Sea-State-Representative-Clusters">
<h2>Calculate Sea State Representative Clusters<a class="headerlink" href="#Calculate-Sea-State-Representative-Clusters" title="Link to this heading"></a></h2>
<p>The above methodology discusses ways to apply MHKiT and industry standards to characterize a wave energy resource. When optimizing a WEC design through simulation it is customary to consider a limited number of representative sea states as the full set of sea states is intractable to simulate during design optimization. Down-selecting a limited number of sea states results in loss of information. The following analysis will compare a full 2D histogram result to several representative sea state
clusters typically referred to as K-means clusters.</p>
<p>We first calculate the total energy flux for the provided data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>nHours = (data_clean.index[1] - data_clean.index[0]).seconds / 3600
Total = data_clean.J.sum() * nHours
print(f&quot;{Total} (W*hr)/m&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
7362866415.622857 (W*hr)/m
</pre></div></div>
</div>
<section id="Down-Select-by-2D-Histogram">
<h3>Down Select by 2D Histogram<a class="headerlink" href="#Down-Select-by-2D-Histogram" title="Link to this heading"></a></h3>
<p>Knowing the total energy flux we may calculate the 2D histogram result and compare it to the total result. We expect this value to near unity. While we have down-selected the number of sea states the histogram is still 100 bins and this is still not generally tractable for WEC optimization. We could continue to reduce the number of histogram bins, however, in sticking with this technique we are generally constrained to a cartesian set of bins.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Jsum, xe, ye, bn = stats.binned_statistic_2d(
    data_clean.Hm0, data_clean.Te, data_clean.J, statistic=&quot;sum&quot;
)  # ,bins=[Te_bins, Hm0_bins])

hist_result = np.round(Jsum.sum().sum() / Total, 4)
print(f&quot;{hist_result} = (2D Histogram J) / (1-year total J) &quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0 = (2D Histogram J) / (1-year total J)
</pre></div></div>
</div>
</section>
<section id="Down-Select-by-K-means-clusters">
<h3>Down Select by K-means clusters<a class="headerlink" href="#Down-Select-by-K-means-clusters" title="Link to this heading"></a></h3>
<p>By choosing a limited number of data clusters we should be able to choose some minimum representative number for our sea state which still captures the resource well. To calculate these we will use a Gaussian-mixture model (a more general K-means method) which allows us to assign data points to an individual cluster and assign weights based on the density of points in that cluster. We will consider varying numbers of clusters (<code class="docutils literal notranslate"><span class="pre">N=[4,</span> <span class="pre">8,</span> <span class="pre">16,</span> <span class="pre">32,</span> <span class="pre">64]</span></code>) and then calculate the representative
energy in each cluster by representing each sea state as a Bretchnider spectrum. In the following code, we will create a plot for each of our N clusters and show where the provided data points fall within each cluster.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Compute Gaussian Mixture Model for each number of clusters
Ns = [4, 8, 16, 32, 64]
X = np.vstack((data_clean.Te.values, data_clean.Hm0.values)).T
fig, axs = plt.subplots(len(Ns), 1, figsize=(8, 24), sharex=True)

results = {}
for N in Ns:
    gmm = GaussianMixture(n_components=N).fit(X)

    # Save centers and weights
    result = pd.DataFrame(gmm.means_, columns=[&quot;Te&quot;, &quot;Hm0&quot;])
    result[&quot;weights&quot;] = gmm.weights_

    result[&quot;Tp&quot;] = result.Te / 0.858
    results[N] = result

    labels = gmm.predict(X)

    i = Ns.index(N)
    axs[i].scatter(data_clean.Te.values, data_clean.Hm0.values, c=labels, s=40)
    axs[i].plot(result.Te, result.Hm0, &quot;m+&quot;)
    axs[i].title.set_text(f&quot;{N} Clusters&quot;)
    plt.setp(axs[i], ylabel=&quot;Energy Period, $T_e$ [s]&quot;)
plt.setp(axs[len(Ns) - 1], xlabel=&quot;Sig. wave height, $Hm0$ [m&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Text(0.5, 0, &#39;Sig. wave height, $Hm0$ [m&#39;)]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PacWave_resource_characterization_example_26_1.png" src="_images/PacWave_resource_characterization_example_26_1.png" />
</div>
</div>
</section>
<section id="Compare-Representative-Sea-State-Energy-to-Total">
<h3>Compare Representative Sea State Energy to Total<a class="headerlink" href="#Compare-Representative-Sea-State-Energy-to-Total" title="Link to this heading"></a></h3>
<p>Lastly, we will compare each sea state’s representative energy to the original total energy of the dataset. As expected we observe increasing agreement with the original total energy as the number of clusters increases.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>w = ndbc_data[year].columns.values
f = w / 2 * np.pi


for N in results:
    result = results[N]
    J = []
    for i in range(len(result)):
        b = resource.jonswap_spectrum(f, result.Tp[i], result.Hm0[i])
        J.extend([resource.energy_flux(b, h=399.0).values[0][0]])

    result[&quot;J&quot;] = J
    results[N] = result

ratios = {}
for N in results:
    J_hr = results[N].J * len(data_clean)
    total_weighted_J = (J_hr * results[N].weights).sum()
    normalized_weighted_J = total_weighted_J / Total
    ratios[N] = np.round(normalized_weighted_J, 4)

pd.Series(ratios)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4     0.8904
8     0.9375
16    0.9732
32    1.0033
64    1.0161
dtype: float64
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, National Renewable Energy Laboratory, Pacific Northwest National Laboratory, and Sandia National Laboratories.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-164358105-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-164358105-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>